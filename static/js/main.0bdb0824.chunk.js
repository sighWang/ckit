(this["webpackJsonpckit-app"]=this["webpackJsonpckit-app"]||[]).push([[0],{1011:function(e,t){},1093:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=function(e){const t=e.raw;return{raw:{inputs:t.inputs.map((e=>({since:e.since,previousOutput:{index:e.previousOutput.index,txHash:e.previousOutput.txHash}}))),inputCells:t.inputCells.map((e=>({lock:{args:e.lock.args,codeHash:e.lock.codeHash,hashType:e.lock.hashType},type:e.type&&{args:e.type.args,hashType:e.type.hashType,codeHash:e.type.codeHash},data:e.getHexData(),capacity:{amount:e.capacity.toHexString()},outPoint:{txHash:e.outPoint.txHash,index:e.outPoint.index}}))),outputs:t.outputs.map((e=>({capacity:{amount:e.capacity.toHexString()},data:e.getHexData(),lock:{args:e.lock.args,hashType:e.lock.hashType,codeHash:e.lock.codeHash},type:e.type&&{args:e.type.args,hashType:e.type.hashType,codeHash:e.type.codeHash}}))),version:t.version,cellDeps:t.cellDeps.map((e=>({depType:e.depType,outPoint:{index:e.outPoint.index,txHash:e.outPoint.txHash}}))),headerDeps:t.headerDeps},witnessArgs:e.witnessArgs,witnesses:e.witnesses}},t.deserialize=function(e){const t=e.raw;return new n.Transaction(new n.RawTransaction(t.inputCells.map(s),t.outputs.map(s),t.cellDeps.map((e=>new n.CellDep("code"===e.depType?n.DepType.code:n.DepType.depGroup,new n.OutPoint(e.outPoint.txHash,e.outPoint.index)))),t.headerDeps,t.version),e.witnessArgs)};var n=i(21);function r(e){return new n.Script(e.codeHash,e.args,"type"===e.hashType?n.HashType.type:n.HashType.data)}function s(e){return new n.Cell(new n.Amount(e.capacity.amount,0),r(e.lock),e.type?r(e.type):void 0,"outPoint"in e&&e.outPoint?new n.OutPoint(e.outPoint.txHash,e.outPoint.index):void 0,e.data)}},1094:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AcpTransferSudtBuilder=void 0;var n=i(159),r=i(215),s=i(1095);class a extends r.AbstractTransactionBuilder{constructor(e,t,i){var n,r,a;super(),this.options=e,this.provider=t,this.sender=i,a=void 0,(r="builder")in(n=this)?Object.defineProperty(n,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[r]=a,this.builder=new s.TransferSudtPwBuilder(e,t,i)}async build(){if(this.options.recipients.find((e=>e.recipient===this.sender)))throw new n.RecipientSameWithSenderError({address:this.sender});return this.builder.build()}}t.AcpTransferSudtBuilder=a},1095:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransferSudtPwBuilder=void 0;var n=i(21),r=i(158),s=i(138),a=i(280),c=i(281);class o extends c.AbstractPwSenderBuilder{constructor(e,t,i){super(t),this.options=e,this.sender=i}async build(){let e=!1;const t=new Map;this.options.recipients.forEach((e=>{const i=t.get(e.sudt.args),n=void 0===i?[{recipient:e.recipient,amount:e.amount,sudt:e.sudt,policy:e.policy}]:i.concat({recipient:e.recipient,amount:e.amount,sudt:e.sudt,policy:e.policy});t.set(e.sudt.args,n)}));const i=[],c=[],o=[],l=[];for(const m of t){let[,t]=m;t=this.deduplicateOptions(t);const u=t[0].sudt;let d=new n.Amount("0",0);for(const i of t){if(d=d.add(new n.Amount(i.amount,0)),"findOrCreate"===i.policy){const e=(await this.provider.collectUdtCells(i.recipient,u,"0"))[0];i.policy=e?"findAcp":"createCell"}switch(i.policy){case"findAcp":{const e=(await this.provider.collectUdtCells(i.recipient,u,"0"))[0];e||(0,s.boom)("recipient ".concat(i.recipient," has no cell to carry the udt"));const t=new n.Cell(new n.Amount(e.output.capacity,0),r.Pw.toPwScript(e.output.lock),e.output.type&&r.Pw.toPwScript(e.output.type),r.Pw.toPwOutPoint(e.out_point),e.output_data),a=new n.Cell(new n.Amount(e.output.capacity,0),r.Pw.toPwScript(e.output.lock),e.output.type&&r.Pw.toPwScript(e.output.type),void 0,e.output_data);a.setSUDTAmount(a.getSUDTAmount().add(new n.Amount(i.amount,0))),c.push(t),l.push(a);break}case"createCell":{e=!0;const t=new n.Cell(new n.Amount("1").add(new n.Amount(String((0,a.byteLenOfSudt)(this.getLockscriptArgsLength(i.recipient))))),r.Pw.toPwScript(this.provider.parseToScript(i.recipient)),r.Pw.toPwScript(u),void 0,new n.Amount(i.amount,0).toUInt128LE());l.push(t);break}}}const h=(await this.provider.collectUdtCells(this.sender,u,d.toHexString())).map(r.Pw.toPwCell);i.push(...h);const[p,f]=h.reduce((([e,t],i)=>[e=e.add(i.capacity),t=t.add(i.getSUDTAmount())]),[n.Amount.ZERO,n.Amount.ZERO]),w=new n.Cell(p,h[0].lock,h[0].type,void 0,f.toUInt128LE());w.setSUDTAmount(w.getSUDTAmount().sub(d)),o.push(w)}if(e){const e=new n.Amount("1").add(new n.Amount(String((0,a.byteLenOfSudt)(this.getLockscriptArgsLength(this.sender)))));o.forEach((t=>{t.capacity.gt(e)&&(t.capacity=e)}))}const u=i.reduce(((e,t)=>e.add(t.capacity)),n.Amount.ZERO),d=o.reduce(((e,t)=>e.add(t.capacity)),n.Amount.ZERO),h=c.reduce(((e,t)=>e.add(t.capacity)),n.Amount.ZERO),p=l.reduce(((e,t)=>e.add(t.capacity)),n.Amount.ZERO),f=h.add(u),w=p.add(d),v=new n.Transaction(new n.RawTransaction(i.concat(c),o.concat(l),this.getCellDepsByCells(i.concat(c),o.concat(l))),i.map((()=>this.getWitnessPlaceholder(this.sender)))),b=n.Builder.calcFee(v,Number(this.provider.config.MIN_FEE_RATE)),g=e&&f.lt(w.add(b)),y=o.find((e=>e.capacity.sub(new n.Amount(String((0,a.byteLenOfSudt)(this.getLockscriptArgsLength(this.sender))))).gte(b)));if(g||!e&&!y){const e=this.getLockscriptArgsLength(this.sender),t=w.add(new n.Amount(String((0,a.byteLenOfCkbLiveCell)(e)))).add(new n.Amount("1")).sub(f),s=await this.provider.collectCkbLiveCells(this.sender,t.toHexString()),u=s.map(r.Pw.toPwCell),d=r.Pw.toPwCell(s[0]);d.capacity=u.reduce(((e,t)=>e.add(t.capacity)),n.Amount.ZERO);const h=i.concat(c).concat(u),p=o.concat(l).concat([d]),v=new n.Transaction(new n.RawTransaction(h,p,this.getCellDepsByCells(h,p)),i.map((()=>this.getWitnessPlaceholder(this.sender)))),b=n.Builder.calcFee(v,Number(this.provider.config.MIN_FEE_RATE));return d.capacity=d.capacity.sub(b).add(f).sub(w),v}if(e){const e=f.sub(w).sub(b);return o[0].capacity=o[0].capacity.add(e),v}return y.capacity=y.capacity.sub(b),v}getLockscriptArgsLength(e){return(this.provider.parseToScript(e).args.length-2)/2}deduplicateOptions(e){const t=new Map;return e.forEach((e=>{const i=t.get(e.recipient);if(i){if(i.policy!==e.policy)throw new Error("error: same recipient and sudt, but different policy");i.amount=new n.Amount(i.amount,0).add(new n.Amount(e.amount,0)).toHexString()}else t.set(e.recipient,e)})),Array.from(t.values())}}t.TransferSudtPwBuilder=o},1096:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellDeps=function(e=!1){let t=r;e&&(t=s);return t},t.nets=void 0;var n=i(21);t.nets=[{name:"dev",url:"https://id.unipass.vip",model:1},{name:"Aggron-Preview",url:"https://t.unipass.xyz",model:0},{name:"Lina-Preview",url:"https://rc.unipass.xyz",model:0},{name:"Lina",url:"https://unipass.xyz"}];const r=[new n.CellDep(n.DepType.code,new n.OutPoint("0x04a1ac7fe15e454741d3c5c9a409efb9a967714ad2f530870514417978a9f655","0x0")),new n.CellDep(n.DepType.code,new n.OutPoint("0x3d41e1c543f0fddcbb17157d15a2845d7c5fb0363561cd8f50ecd0e118b34f84","0x0")),new n.CellDep(n.DepType.code,new n.OutPoint("0xd346695aa3293a84e9f985448668e9692892c959e7e83d6d8042e59c08b8cf5c","0x0"))],s=[new n.CellDep(n.DepType.code,new n.OutPoint("0x1a04142a2a745fb3b7e0e9b61241676c1c94ad8cdacb36f223661130a23fb007","0x0")),new n.CellDep(n.DepType.code,new n.OutPoint("0xf247a0e9dfe9d559ad8486428987071b65d441568075465c2810409e889f4081","0x0")),new n.CellDep(n.DepType.code,new n.OutPoint("0x1196caaf9e45f1959ea3583f92914ee8306d42e27152f7068f9eeb52ac23eeae","0x0"))]},1097:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransferCkbBuilder=void 0;var n=i(159),r=i(215),s=i(1098);class a extends r.AbstractTransactionBuilder{constructor(e,t,i){super(),this.options=e,this.provider=t,this.sender=i}async build(){if(this.options.recipients.some((e=>e.recipient===this.sender&&"findAcp"===e.capacityPolicy)))throw new n.RecipientSameWithSenderError({address:this.sender});return new s.TransferCkbPwBuilder(this.options,this.provider,this.sender).build()}}t.TransferCkbBuilder=a},1098:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TransferCkbPwBuilder=void 0;var n=i(21),r=i(399),s=i(159),a=i(158),c=i(280),o=i(281);class l extends o.AbstractPwSenderBuilder{constructor(e,t,i){super(t),this.options=e,this.sender=i}async build(){const e=this.options.recipients.filter((e=>"createCell"===e.capacityPolicy)).map((e=>new n.Cell(new n.Amount(e.amount,0),a.Pw.toPwScript(this.provider.parseToScript(e.recipient))))),t=this.options.recipients.filter((e=>"findAcp"===e.capacityPolicy)),i=(0,r.from)(t).pipe((0,r.mergeMap)((async e=>{const t=(await this.provider.collectCkbLiveCells(e.recipient,"0"))[0];if(!t)throw new s.NoAvailableCellError({lock:this.provider.parseToScript(e.recipient)});const i=a.Pw.toPwCell(t);return i.capacity=i.capacity.add(new n.Amount(e.amount,0)),i})),(0,r.toArray)()),o=await(0,r.lastValueFrom)(i),u=e.reduce(((e,t)=>e.add(t.capacity)),n.Amount.ZERO),d=t.reduce(((e,t)=>e.add(new n.Amount(t.amount,0))),n.Amount.ZERO),h=(await this.provider.collectCkbLiveCells(this.sender,d.add(u).add(new n.Amount(String((0,c.byteLenOfCkbLiveCell)()))).add(new n.Amount("1")).toHexString())).map(a.Pw.toPwCell);if(!h.length||!h[0])throw new s.NoAvailableCellError({lock:this.provider.parseToScript(this.sender)});const p=h[0];p.capacity=h.reduce(((e,t)=>e.add(t.capacity)),new n.Amount("0",0));const f=[...h,...o],w=[p,...o,...e],v=new n.Transaction(new n.RawTransaction(f,w,this.getCellDepsByCells(f,w)),[this.getWitnessPlaceholder(this.sender)]),b=l.calcFee(v);return p.capacity=p.capacity.sub(u).sub(d).sub(b),v}}t.TransferCkbPwBuilder=l},1099:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MintSudtBuilder=void 0;var n=i(159),r=i(215),s=i(1100);class a extends r.AbstractTransactionBuilder{constructor(e,t,i){super(),this.options=e,this.provider=t,this.sender=i}async buildPwTransaction(){const e=new s.NonAcpPwMintBuilder(this.options,this.provider,this.sender);return await e.build()}async build(){if(this.options.recipients.some((e=>e.recipient===this.sender&&"createCell"!==e.capacityPolicy)))throw new n.RecipientSameWithSenderError({address:this.sender});return this.buildPwTransaction()}}t.MintSudtBuilder=a},1100:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonAcpPwMintBuilder=void 0;var n=i(21),r=i(399),s=i(159),a=i(158),c=i(280),o=i(281);class l extends o.AbstractPwSenderBuilder{constructor(e,t,i){super(t),this.options=e,this.issuerAddress=i}async build(){const e=this.provider.newSudtScript(this.issuerAddress),t=this.options.recipients.filter((e=>"createCell"===e.capacityPolicy)).map((t=>{var i;const r=(this.provider.parseToScript(t.recipient).args.length-2)/2;return new n.Cell(new n.Amount(String(BigInt(t.additionalCapacity||0)),0).add(new n.Amount(String((0,c.byteLenOfSudt)(r)))),a.Pw.toPwScript(this.provider.parseToScript(t.recipient)),a.Pw.toPwScript(null!==(i=t.sudt)&&void 0!==i?i:e),void 0,new n.Amount(t.amount,0).toUInt128LE())})),i=this.options.recipients.filter((e=>"findAcp"===e.capacityPolicy)),o=(0,r.from)(i).pipe((0,r.mergeMap)((async t=>{var i;const r=(await this.provider.collectUdtCells(t.recipient,null!==(i=t.sudt)&&void 0!==i?i:e,"0"))[0];if(!r)throw new s.NoAvailableCellError({lock:this.provider.parseToScript(t.recipient),type:e});const c=a.Pw.toPwCell(r);return c.capacity=c.capacity.add(new n.Amount(t.additionalCapacity||"0",0)),c.setSUDTAmount(c.getSUDTAmount().add(new n.Amount(t.amount,0))),c}),5),(0,r.toArray)()),l=await(0,r.lastValueFrom)(o),u=t.reduce(((e,t)=>e.add(t.capacity)),n.Amount.ZERO),d=i.reduce(((e,t)=>e.add(new n.Amount(t.additionalCapacity||"0",0))),n.Amount.ZERO),h=u.add(d).add(new n.Amount(String((0,c.byteLenOfCkbLiveCell)()))).add(new n.Amount("1")),p=(await this.provider.collectCkbLiveCells(this.issuerAddress,h.toHexString())).map(a.Pw.toPwCell),f=p[0].clone();f.capacity=p.reduce(((e,t)=>e.add(t.capacity)),n.Amount.ZERO);const w=[...p,...l],v=[f,...t,...l],b=new n.RawTransaction(w,v,this.getCellDepsByCells(w,v)),g=new n.Transaction(b,[this.getWitnessPlaceholder(this.issuerAddress)]),y=n.Builder.calcFee(g,Number(this.provider.config.MIN_FEE_RATE));return f.capacity=f.capacity.sub(y).sub(u).sub(d),g}}t.NonAcpPwMintBuilder=l},1101:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1102);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}));var r=i(1105);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var s=i(212);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}))},1102:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateRcUdtInfoCellBuilder=void 0;var n=i(150),r=i(215),s=i(1103);class a extends r.AbstractTransactionBuilder{constructor(e,t){var i,n,r;super(),this.options=e,this.provider=t,r=void 0,(n="builtTransaction")in(i=this)?Object.defineProperty(i,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):i[n]=r}async build(){return this.builtTransaction=await new s.CreateRcUdtInfoCellPwBuilder(this.options,this.provider).build(),this.builtTransaction}getTypeHash(){if(!this.builtTransaction)throw new Error("Transaction is not built yet");const e=this.builtTransaction.raw.outputs[0];return(0,n.invariant)(e&&e.type),e.type.toHash()}getIssuerLockHash(){if(!this.builtTransaction)throw new Error("Transaction is not built yet");const e=this.builtTransaction.raw.outputs[0];return(0,n.invariant)(e&&e.type),e.lock.toHash()}}t.CreateRcUdtInfoCellBuilder=a},1103:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CreateRcUdtInfoCellPwBuilder=void 0;var n=i(114),r=i(298),s=i(212),a=i(150),c=i(21),o=i(99),l=i(507),u=i(158),d=i(280),h=i(281);class p extends h.AbstractPwSenderBuilder{constructor(e,t){super(t),this.options=e,this.provider=t}async build(){const{sudtInfo:e,rcIdentity:t}=this.options,i=this.provider,h=(0,s.SerializeUdtInfo)({name:o.Reader.fromRawString(e.name).toArrayBuffer(),symbol:o.Reader.fromRawString(e.symbol).toArrayBuffer(),decimals:e.decimals,description:o.Reader.fromRawString(e.description).toArrayBuffer()}),f=(0,d.byteLenOfRcCell)(54,32,65+h.byteLength),w=i.newScript("RC_LOCK",a.bytes.concat(t.flag,t.pubkeyHash,0)),v=i.parseToAddress(w),b=await i.collectCkbLiveCells(v,l.CkbAmount.fromCkb((0,d.byteLenOfRcCell)(22,0,0)+f+1).toHex());(0,a.invariant)(b[0]);const g=u.Pw.toPwScript(i.generateTypeIdScript({previous_output:b[0].out_point,since:"0x0"},"0x0")),y=u.Pw.toPwScript(i.newScript("RC_LOCK",a.bytes.concat(t.flag,t.pubkeyHash,"08",g.toHash()))),m=new c.Cell(new c.Amount(String(f),8),y,g,void 0,a.bytes.concat((0,r.formatByteLike)(s.RcSupplyOutputData.encode({version:0,current_supply:0n,max_supply:BigInt(e.maxSupply),sudt_script_hash:n.utils.computeScriptHash(i.newSudtScript(u.Pw.fromPwScript(y)))})),(0,r.formatByteLike)(new Uint8Array(h)))),j=b.map(u.Pw.toPwCell),_=j[0];(0,a.invariant)(_),_.capacity=j.reduce(((e,t)=>e.add(t.capacity)),new c.Amount("0"));const x=new c.RawTransaction(j,[m,_],this.getCellDepsByCells(j,[m,_])),O=new c.Transaction(x,[this.getWitnessPlaceholder(i.parseToAddress(i.newScript("RC_LOCK")))]),S=p.calcFee(O);return _.capacity=_.capacity.sub(new c.Amount(String(f),8)).sub(S),O}}t.CreateRcUdtInfoCellPwBuilder=p},1104:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CkbAmount=t.Amount=void 0;var n=i(291),r=i(138);function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e){return"bigint"===typeof e||c.checkIsAmount(e)?new n.BigNumber(String(e)):new n.BigNumber(e)}class c{static checkIsAmount(e){return"object"===typeof e&&(null!=e&&("__isCkitAmount__"in e&&e.__isCkitAmount__))}static from(e,t=0){return(t<0||!Number.isInteger(t))&&(0,r.boom)("The decimal not valid"),new c("bigint"===typeof e?a(e*10n**BigInt(t)):t?a(e).times(a(10).pow(t)):a(e))}constructor(e){if(s(this,"__isCkitAmount__",!0),s(this,"raw",void 0),!e.isInteger())throw new Error("Amount must be an integer");if(e.lt(0))throw new Error("Amount must cannot be a negative number");this.raw=new n.BigNumber(e)}humanize(e){const{decimalPlaces:t=1/0,separator:i=!0,decimals:r=0}=e||{},s=this.raw.times(10**-r),a=s.decimalPlaces(),c=s.decimalPlaces(Math.min(a,t),n.BigNumber.ROUND_FLOOR);return i?c.toFormat():c.toString()}new(e){return new c(e)}toString(e){return this.raw.toString(e)}toHex(){return"0x"+this.toString(16)}eq(e){return this.raw.eq(a(e))}gt(e){return this.raw.gt(a(e))}gte(e){return this.raw.gte(a(e))}lt(e){return this.raw.lt(a(e))}lte(e){return this.raw.lte(a(e))}plus(e){return this.new(this.raw.plus(a(e)))}minus(e){return this.new(this.raw.minus(a(e)))}asBN(){return new n.BigNumber(this.raw)}}t.Amount=c;class o extends c{static from(){throw new Error("Use the Amount.from to instead of")}static fromCkb(e){return new o(a(e).times(10**8))}static fromShannon(e){return new o(a(e))}new(e){return new o(e)}humanize(e){return super.humanize({...e,decimals:8})}}t.CkbAmount=o},1105:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MintRcUdtBuilder=void 0;var n=i(215),r=i(1106);class s extends n.AbstractTransactionBuilder{constructor(e,t){super(),this.options=e,this.provider=t}build(){return new r.MintRcUdtPwBuilder(this.options,this.provider).build()}}t.MintRcUdtBuilder=s},1106:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MintRcUdtPwBuilder=void 0;var n=i(298),r=i(212),s=i(150),a=i(21),c=i(659),o=i(399),l=i(159),u=i(158),d=i(138),h=i(280),p=i(281);class f extends p.AbstractPwSenderBuilder{constructor(e,t){super(t),this.options=e,this.provider=t}async determineFindOrCreate(){const e=new r.RcSupplyLockHelper(this.provider.mercury,{rcLock:this.provider.newScriptTemplate("RC_LOCK"),sudtType:this.provider.newScriptTemplate("SUDT")}),t=await e.listCreatedInfoCells(this.options),i=(0,d.nonNullable)(t[0]),n=this.provider.newSudtScript(this.provider.parseToAddress(i.output.lock)),[s,l]=(0,c.partition)(this.options.recipients,(e=>"findOrCreate"===e.capacityPolicy)),u=(0,c.groupBy)(s,(e=>e.recipient)),h=(0,c.map)(u,(e=>e.reduce(((e,t)=>({...e,amount:new a.Amount(e.amount,0).add(new a.Amount(t.amount,0)).toHexString(),additionalCapacity:new a.Amount(e.additionalCapacity||"0",0).add(new a.Amount(t.additionalCapacity||"0",0)).toHexString()}))))),p=(0,o.from)(h).pipe((0,o.mergeMap)((e=>this.provider.collectUdtCells(e.recipient,n,"0").then((t=>({...e,capacityPolicy:t.length>0?"findAcp":"createCell"})))),5),(0,o.toArray)());return(await(0,o.lastValueFrom)(p)).concat(l)}async build(){this.options={...this.options,recipients:await this.determineFindOrCreate()};const e=new r.RcSupplyLockHelper(this.provider.mercury,{rcLock:this.provider.newScriptTemplate("RC_LOCK"),sudtType:this.provider.newScriptTemplate("SUDT")}),t=await e.listCreatedInfoCells(this.options),i=(0,d.nonNullable)(t[0]),{rc_identity_flag:c,rc_identity_pubkey_hash:p}=r.RcSupplyLockArgs.decode((0,n.toBuffer)(i.output.lock.args)),f=u.Pw.toPwCell(i),w=this.provider.parseToAddress(this.provider.newScript("RC_LOCK",(0,n.formatByteLike)(r.RcIdentityLockArgs.encode({rc_identity_flag:c,rc_identity_pubkey_hash:p,rc_lock_flag:0}),{pad0x:!0}))),v=this.provider.newSudtScript(this.provider.parseToAddress(i.output.lock)),b=this.options.recipients.filter((e=>"createCell"===e.capacityPolicy)).map((e=>new a.Cell(new a.Amount(String(BigInt(e.additionalCapacity||0)),0).add(new a.Amount(String((0,h.byteLenOfSudt)()))),u.Pw.toPwScript(this.provider.parseToScript(e.recipient)),u.Pw.toPwScript(v),void 0,new a.Amount(e.amount,0).toUInt128LE()))),g=this.options.recipients.filter((e=>"findAcp"===e.capacityPolicy)),y=(0,o.from)(g).pipe((0,o.mergeMap)((async e=>{const t=(await this.provider.collectUdtCells(e.recipient,v,"0"))[0];if(!t)throw new l.NoAvailableCellError({lock:this.provider.parseToScript(e.recipient),type:v});const i=u.Pw.toPwCell(t);return i.capacity=i.capacity.add(new a.Amount(e.additionalCapacity||"0",0)),i.setSUDTAmount(i.getSUDTAmount().add(new a.Amount(e.amount,0))),i}),5),(0,o.toArray)()),m=await(0,o.lastValueFrom)(y),j=b.reduce(((e,t)=>e.add(t.capacity)),a.Amount.ZERO),_=g.reduce(((e,t)=>e.add(new a.Amount(t.additionalCapacity||"0",0))),a.Amount.ZERO),x=a.Amount.ZERO.add(j).add(_).add(new a.Amount(String((0,h.byteLenOfCkbLiveCell)(r.RcIdentityLockArgs.byteWidth)))).add(new a.Amount("1")),O=(await this.provider.collectCkbLiveCells(w,x.toHexString())).map(u.Pw.toPwCell),S=O[0].clone();S.capacity=O.reduce(((e,t)=>e.add(t.capacity)),a.Amount.ZERO);const A=this.options.recipients.reduce(((e,t)=>BigInt(t.amount)+e),0n),P=(0,n.toBuffer)(f.getHexData()),C=r.RcSupplyOutputData.decode(P),E=r.RcSupplyOutputData.encode({...C,current_supply:C.current_supply+A});P.write(E.toString("hex"),"hex"),f.setHexData(s.bytes.toHex(P));const k=[f,...O,...m],U=new a.RawTransaction(k,[f,S,...b,...m],this.getCellDepsByCells(k,[f,S,...b,...m])),z=new a.Transaction(U,[this.getWitnessPlaceholder(w),this.getWitnessPlaceholder(w)]),T=a.Builder.calcFee(z,Number(this.provider.config.MIN_FEE_RATE));return S.capacity=S.capacity.sub(T).sub(j).sub(_),z}}t.MintRcUdtPwBuilder=f},1107:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PwAdapterSigner=void 0;var n=i(21),r=i(158);function s(e){const t=new DataView(new ArrayBuffer(8));return t.setUint32(0,e,!0),t.buffer}t.PwAdapterSigner=class{constructor(e,t,i=new n.Blake2bHasher){this.rawSigner=e,this.provider=t,this.hasher=i}async signMessages(e){const t=[],i=r.Pw.toPwScript(this.provider.parseToScript(await this.rawSigner.getAddress()));for(const n of e){if(n.lock.codeHash!==i.codeHash||n.lock.hashType!==i.hashType)continue;const e=await this.rawSigner.signMessage(n.message);t.push(e)}return t}async sign(e){const t=this.toMessages(e),i=await this.signMessages(t);for(let r=0;r<t.length;r++){const{index:s}=t[r];s<e.witnessArgs.length&&"string"!==typeof e.witnessArgs[s]&&(i[r]=new n.Reader((0,n.SerializeWitnessArgs)(n.normalizers.NormalizeWitnessArgs({...e.witnessArgs[s],lock:i[r]}))).serializeJson())}return e=function(e,t,i){if(t.length!==i.length)throw new Error("Invalid number of witnesses!");for(let n=0;n<t.length;n++)e.witnesses[t[n].index]=i[n];return e}(e,t,i)}toMessages(e){if(e.validate(),e.raw.inputs.length!==e.raw.inputCells.length)throw new Error("Input number does not match!");const t=(new n.Blake2bHasher).hash(new n.Reader((0,n.SerializeRawTransaction)(n.normalizers.NormalizeRawTransaction(n.transformers.TransformRawTransaction(e.raw))))),i=[],r=e.raw.inputs.map((e=>!1));for(let a=0;a<e.raw.inputs.length;a++){if(r[a]||"0x"===e.witnesses[a])continue;if(a>=e.witnesses.length)throw new Error("Input ".concat(a," starts a new script group, but witness is missing!"));r[a]=!0,this.hasher.update(t);const c=new n.Reader(e.witnesses[a]);this.hasher.update(s(c.length())),this.hasher.update(c);for(let t=a+1;t<e.raw.inputs.length&&t<e.witnesses.length;t++)if(e.raw.inputCells[a].lock.sameWith(e.raw.inputCells[t].lock)){r[t]=!0;const i=new n.Reader(e.witnesses[t]);this.hasher.update(s(i.length())),this.hasher.update(i)}i.push({index:a,message:this.hasher.digest().serializeJson(),lock:e.raw.inputCells[a].lock}),this.hasher.reset()}return i}}},1109:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Secp256k1Signer=t.Secp256k1Wallet=void 0;var n=i(469),r=i(205),s=i(282);function a(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,o(e,t,"get"))}function c(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=i}}(e,o(e,t,"set"),i),i}function o(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return t.get(e)}var l=new WeakMap;class u extends r.AbstractWallet{constructor(e,t,i){super(),this.provider=t,this.lockConfig=i,l.set(this,{writable:!0,value:void 0}),this.setDescriptor({features:["issue-sudt"]}),c(this,l,e)}async tryConnect(){return new h(a(this,l),this.provider,this.lockConfig)}}t.Secp256k1Wallet=u;var d=new WeakMap;class h extends s.AbstractSingleEntrySigner{static privateKeyToBlake160(e){return n.key.privateKeyToBlake160(e)}constructor(e,t,i){super({provider:t}),this.provider=t,this.lockConfig=i,d.set(this,{writable:!0,value:void 0}),c(this,d,e)}getAddress(){return Promise.resolve(this.provider.parseToAddress({...this.lockConfig,args:h.privateKeyToBlake160(a(this,d))}))}signMessage(e){const t=n.key.signRecoverable(e,a(this,d));return Promise.resolve(t)}}t.Secp256k1Signer=h},1110:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnipassWallet=void 0;var n=i(205),r=i(282),s=i(1111);function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class c extends n.AbstractWallet{constructor(e,t){super(),this.provider=e,a(this,"adapter",void 0),this.setDescriptor({name:"UnipassWallet",description:"Interacting with CKB via an Email",features:["acp"]}),this.adapter=new s.UnipassRedirectAdapter(null!==t&&void 0!==t?t:{})}async tryConnect(){const e=await this.adapter.getLockArgs(),t=this.provider,i=e=>Promise.resolve(this.adapter.sign(e));return new class extends r.AbstractSingleEntrySigner{getAddress(){return Promise.resolve(t.parseToAddress(t.newScript("UNIPASS",e)))}signMessage(e){return i(e)}seal(e){return super.seal(e)}}({provider:this.provider})}}t.UnipassWallet=c,a(c,"UnipassRedirectAdapter",s.UnipassRedirectAdapter)},1111:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pubkeyToLockArgs=c,t.getRetFromSearchParams=o,t.redirect=l,t.UnipassRedirectAdapter=void 0;var n=i(114),r=i(138);function s(e){return"object"===typeof e&&null!==e&&("email"in e&&"pubkey"in e)}function a(e){return"object"===typeof e&&null!==e&&("sig"in e&&"pubkey"in e)}function c(e){return n.utils.ckbHash((0,r.hexToBytes)(e).buffer).serializeJson().slice(0,42)}function o(e,t=!1){const i=new URLSearchParams(location.search.slice(1)),n=i.get("unipass_ret");if(!n)return;const r=JSON.parse(n);if(!e(r.data))return;if(200!==r.code)throw new Error(r.info||"Unknown error when connecting to UniPass");i.delete("unipass_ret");const{pathname:s,host:a,protocol:c}=window.location,o=i.toString(),l="".concat(c,"//").concat(a).concat(s).concat(o?"?".concat(o):"");return t&&window.history.replaceState({path:l},"",l),r.data}async function l(e){return window.location.href=e,new Promise((e=>setTimeout(e,6e4)))}t.UnipassRedirectAdapter=class{constructor(e){var t,i,n,r,s;s=void 0,(r="config")in(n=this)?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s,this.config={host:null!==(t=e.host)&&void 0!==t?t:"https://t.unipass.xyz",loginDataCacheKey:null!==(i=e.loginDataCacheKey)&&void 0!==i?i:"__unipass__"}}saveLoginInfo(){this.getLoginDataFromUrl()&&this.getLoginDataFromCache()}hasLoginInfo(){return!!o(s)}hasSigData(){return!!o(a)}async getLockArgs(){var e,t;return c((null!==(e=null!==(t=this.getLoginDataFromCache())&&void 0!==t?t:this.getLoginDataFromUrl())&&void 0!==e?e:await this.redirectToLogin()).pubkey)}sign(e){var t;return Promise.resolve(null!==(t=this.getSignatureFromUrl())&&void 0!==t?t:this.redirectToSign(e))}redirectToLogin(){return l(this.generateUnipassNewUrl(this.config.host,"login",{success_url:window.location.href}))}redirectToSign(e){var t;const i=null===(t=this.getLoginDataFromCache())||void 0===t?void 0:t.pubkey;if(!i)throw new Error("UniPass should login before sign");return l(this.generateUnipassNewUrl(this.config.host,"sign",{success_url:window.location.href,pubkey:i,message:e}))}saveLoginDataToCache(e){localStorage.setItem(this.config.loginDataCacheKey,JSON.stringify(e))}getLoginDataFromCache(){const e=localStorage.getItem(this.config.loginDataCacheKey);if(null!=e)return JSON.parse(e)}getLoginDataFromUrl(){const e=o(s,!0);if(e)return this.saveLoginDataToCache(e),e}getSignatureFromUrl(){const e=o(a,!0);if(e)return"0x01"+e.sig.replace("0x","")}generateUnipassNewUrl(e,t,i){const n=new URL("".concat(e,"/").concat(t.toLowerCase()));return Object.entries(i).forEach((([e,t])=>n.searchParams.set(e,t))),n.href}}},1112:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RcPwSigner=t.RcOwnerWallet=void 0;var n=i(205),r=i(212),s=i(150),a=i(99),c=i(282),o=i(508);class l extends n.AbstractWallet{constructor(e){super(),this.provider=e,this.setDescriptor({name:"RcWallet"})}describeFeatures(){return["issue-sudt"]}async tryConnect(){const e=await(0,o.detect)();return e.selectedAddress||await e.request({method:"eth_requestAccounts"}),e.addListener("accountsChanged",(t=>{t&&t.length>0?super.emitChangedSigner(new u(this.provider,e)):super.emitConnectStatusChanged("disconnected")})),new u(this.provider,e)}}t.RcOwnerWallet=l;class u extends c.AbstractSingleEntrySigner{constructor(e,t){super({provider:e}),this.provider=e,this.ethProvider=t}getAddress(){const e=s.bytes.toHex(r.RcIdentityLockArgs.encode({rc_identity_flag:r.RcIdentityFlag.ETH,rc_identity_pubkey_hash:this.ethProvider.selectedAddress,rc_lock_flag:0}));return this.provider.parseToAddress(this.provider.newScript("RC_LOCK",e))}getRcIdentity(){return{flag:r.RcIdentityFlag.ETH,pubkeyHash:this.ethProvider.selectedAddress}}async personalSign(e){const t=this.ethProvider.selectedAddress;return this.ethProvider.request({method:"personal_sign",params:[t,e]})}async signMessage(e){const t=await this.personalSign(e);let i=Number.parseInt(t.slice(-2),16);i>=27&&(i-=27);const n="0x"+t.slice(2,-2)+i.toString(16).padStart(2,"0");return Promise.resolve(new a.Reader((0,r.SerializeRcLockWitnessLock)({signature:new a.Reader(n)})).serializeJson())}}t.RcPwSigner=u},1113:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(660);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}));var r=i(1128);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}))},1115:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MercuryClient=void 0;var n=i(1116);t.MercuryClient=class{constructor(e){var t,i,r;r=void 0,(i="client")in(t=this)?Object.defineProperty(t,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[i]=r;const s=new n.HTTPTransport(e,{headers:{"content-type":"application/json"}});this.client=new n.Client(new n.RequestManager([s]))}get_cells(e){const{search_key:t,order:i="asc",limit:n="0x3e8",after_cursor:r}=e;return this.client.request({method:"get_cells",params:[t,i,n,r]})}get_tip(){return this.client.request({method:"get_tip"})}}},1127:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MercuryCellProvider=void 0;t.MercuryCellProvider=class{constructor(e){this.mercury=e}collector(e){const{lock:t,type:i}=e;let n;if(void 0!==t)n={script:t,script_type:"lock"},void 0!=i&&"empty"!==i&&(n.filter={script:i});else{if(void 0==i||"empty"==i)throw new Error("should specify either type or lock in queries, queries now: ".concat(JSON.stringify(e)));n={script:i,script_type:"type"}}const r=e.data||"0x",s=this.mercury;return{collect:()=>({async*[Symbol.asyncIterator](){for(;;){const e=(await s.get_cells({search_key:n})).objects;for(const t of e)"any"!==r&&r!==t.output_data||(yield{cell_output:t.output,data:t.output_data,out_point:t.out_point,block_number:t.block_number});if(e.length<100)break}}})}}}},1128:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CkitProvider=void 0;var n=i(114),r=i(660);class s extends r.MercuryProvider{get config(){return super.config}init(e){return super.init(e)}getScriptConfig(e){const t=super.getScriptConfig(e);if(!t)throw new Error("cannot find the ".concat(e," script config, maybe init failed"));return t}newScript(e,t="0x"){const i=super.newScript(e,t);if(!i)throw new Error("cannot find the ".concat(e," script config, maybe init failed"));return i}newScriptTemplate(e){const t=this.newScript(e);return{code_hash:t.code_hash,hash_type:t.hash_type}}newSudtScript(e){const t="string"===typeof e?n.utils.computeScriptHash(this.parseToScript(e)):n.utils.computeScriptHash(e);return this.newScript("SUDT",t)}getCellDep(e){const t=super.getCellDep(e);if(!t)throw new Error("cannot find the ".concat(e," script config, maybe init failed"));return t}}t.CkitProvider=s},1129:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.predefined=void 0;var n=a(i(1130)),r=a(i(1131));function s(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(s=function(e){return e?i:t})(e)}function a(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var i=s(t);if(i&&i.has(e))return i.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=r?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(n,a,c):n[a]=e[a]}return n.default=e,i&&i.set(e,n),n}const c={Aggron:{PREFIX:"ckt",SCRIPTS:n.SCRIPTS},Lina:{PREFIX:"ckb",SCRIPTS:r.SCRIPTS}};t.predefined=c},1130:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCRIPTS=void 0;var n=i(297);const r={SECP256K1_BLAKE160:n.predefined.AGGRON4.SCRIPTS.SECP256K1_BLAKE160,ANYONE_CAN_PAY:n.predefined.AGGRON4.SCRIPTS.ANYONE_CAN_PAY,SUDT:n.predefined.AGGRON4.SCRIPTS.SUDT,PW_ANYONE_CAN_PAY:{CODE_HASH:"0x093ba9759e1c4a79dd81b0a50de83ab108ffe4eb983b05637bf1f5c1834f31eb",HASH_TYPE:"data",TX_HASH:"0x834d1827950545da5cca779903ca8268aecbc7bfadb1d1cc18ba90f3b312cd41",INDEX:"0x2",DEP_TYPE:"code"},PW_NON_ANYONE_CAN_PAY:{CODE_HASH:"0x87366c3678f14ccbd6647386a18e05ae27c97978d4a6952fb5820cc698263835",HASH_TYPE:"data",TX_HASH:"0x834d1827950545da5cca779903ca8268aecbc7bfadb1d1cc18ba90f3b312cd41",INDEX:"0x3",DEP_TYPE:"code"},UNIPASS:{INDEX:"0x0",TX_HASH:"0x03dd2a5594ed2d79196b396c83534e050ba0ad07fa5c1cd61a7094f9fb60a592",DEP_TYPE:"code",CODE_HASH:"0x124a60cd799e1fbca664196de46b3f7f0ecb7138133dcaea4893c51df5b02be6",HASH_TYPE:"type"},RC_LOCK:{CODE_HASH:"0x79f90bb5e892d80dd213439eeab551120eb417678824f282b4ffb5f21bad2e1e",HASH_TYPE:"type",TX_HASH:"0xe563433a510dfae33252eeef81246e94a6638cdb13ff1a3dc3ac7ab8868b6b26",INDEX:"0x0",DEP_TYPE:"code"}};t.SCRIPTS=r},1131:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SCRIPTS=void 0;var n=i(297);const r={SECP256K1_BLAKE160:n.predefined.LINA.SCRIPTS.SECP256K1_BLAKE160,ANYONE_CAN_PAY:n.predefined.LINA.SCRIPTS.ANYONE_CAN_PAY,SUDT:n.predefined.LINA.SCRIPTS.SUDT,PW_ANYONE_CAN_PAY:{CODE_HASH:"0x",HASH_TYPE:"data",TX_HASH:"0x",INDEX:"0x",DEP_TYPE:"code"},PW_NON_ANYONE_CAN_PAY:{CODE_HASH:"0x",HASH_TYPE:"data",TX_HASH:"0x",INDEX:"0x",DEP_TYPE:"code"},UNIPASS:{INDEX:"0x0",TX_HASH:"0x1a04142a2a745fb3b7e0e9b61241676c1c94ad8cdacb36f223661130a23fb007",DEP_TYPE:"code",CODE_HASH:"0x614d40a86e1b29a8f4d8d93b9f3b390bf740803fa19a69f1c95716e029ea09b3",HASH_TYPE:"type"},RC_LOCK:{CODE_HASH:"0x9f3aeaf2fc439549cbc870c653374943af96a0658bd6b51be8d8983183e6f52f",HASH_TYPE:"type",TX_HASH:"0x56ca53b2a733cc0725a656a433572d8f76d37051b1f2322a9e9d49f39e219c3f",INDEX:"0x0",DEP_TYPE:"code"}};t.SCRIPTS=r},1208:function(e,t,i){},1210:function(e,t,i){"use strict";i.r(t);var n=i(0),r=i.n(n),s=i(55),a=i.n(s),c=(i(700),i(1228)),o=i(438),l=i(60),u=i(447),d=i(167),h=i(49),p=i(78),f=i(437);function w(){const e=Object(n.useMemo)((()=>({ckitConfig:l.predefined.Aggron,mecuryRPC:"https://testnet.ckb.dev/indexer",ckbRPC:"https://testnet.ckb.dev/rpc",nervosExploreTxUrlPrefix:"https://explorer.nervos.org/aggron/transaction/",nervosExploreAddressUrlPrefix:"https://explorer.nervos.org/aggron/address/",nervosExploreSudtUrlPrefix:"https://explorer.nervos.org/aggron/sudt/"})),[]);return Object(d.useLocalStorage)("localConfig",e)}const v=Object(f.a)((()=>{const[e,t]=Object(n.useState)(),[i]=w();return Object(n.useEffect)((()=>{const e=new l.CkitProvider(i.mecuryRPC,i.ckbRPC);e.init({...i.ckitConfig}).then((()=>t(e)))}),[i]),e}));class b extends l.NonAcpPwLockWallet{constructor(e){super(e),this.setDescriptor({name:"MetaMask(Non-ACP)"}),Object(h.e)(this,{connectStatus:h.f,signer:h.f})}}class g extends l.AcpPwLockWallet{constructor(e){super(e),this.setDescriptor({name:"MetaMask(ACP)"}),Object(h.e)(this,{connectStatus:h.f,signer:h.f})}}class y extends l.UnipassWallet{constructor(e){super(e),this.setDescriptor({name:"UniPass"}),Object(h.e)(this,{connectStatus:h.f,signer:h.f})}}const m=Object(f.a)((function(){const e=v.useContainer(),[t,i]=Object(d.useLocalStorage)("currentWalletName"),r=Object(p.b)((()=>[])),[s,a]=Object(n.useState)(),[c,o]=Object(n.useState)(null),[l,u]=Object(n.useState)(!1),[f,w]=Object(n.useState)(!1),m=Object(n.useCallback)((e=>{u(e),o(null)}),[]);Object(n.useEffect)((()=>{e&&Object(h.g)((()=>{var i;r.splice(0),r.push(new y(e),new b(e),new g(e)),null===(i=r.find((e=>e.descriptor.name===t)))||void 0===i||i.connect()}))}),[e]),Object(n.useEffect)((()=>Object(h.b)((()=>{r&&r.forEach(((e,t)=>{e.on("connectStatusChanged",(t=>{if("disconnected"===t){const e=r.find((e=>"connected"===e.connectStatus));i(e?e.descriptor.name:null)}if("connected"===t){m(!1);const t=r.find((t=>t.descriptor.name===e.descriptor.name));if(!t)throw new Error("exception: wallet could not be found");i(t.descriptor.name)}})),e.on("error",(e=>o({error:e,index:t})))}))}))),[m,r]);const j=r.find((e=>e.descriptor.name===t));return Object(n.useEffect)((()=>{Object(h.b)((()=>{var e;a(void 0);const i=r.find((e=>e.descriptor.name===t));Promise.resolve(null===i||void 0===i||null===(e=i.signer)||void 0===e?void 0:e.getAddress()).then((e=>{a(e),w(!0)}))}))}),[t]),{isInitialized:f,wallets:r,currentWallet:j,setCurrentWalletName:i,signerAddress:s,error:c,setError:o,visible:l,setModalVisible:m}})),j=e=>e||"unknown";var _=i(1226),x=i(1230);function O(){const[e,t]=Object(d.useLocalStorage)("unipassTx"),i=new l.UnipassWallet.UnipassRedirectAdapter({host:"https://unipass.xyz"});return{shouldLogin:i.hasLoginInfo(),cacheLogin:()=>i.saveLoginInfo(),shouldSendTx:i.hasSigData(),cacheTx:t,clearTx:()=>t(null),cachedTx:e}}var S=i(291);class A{constructor(e,t){this.rawAmount=void 0,this.decimals=void 0,this.rawAmount=new S.BigNumber(e),this.decimals=t}static fromRaw(e,t){return new A(e,t)}static fromHumanize(e,t){const i=new S.BigNumber(e).times(10**t);return new A(i,t)}toRawString(){return this.rawAmount.toString()}toHexString(){return"0x"+this.rawAmount.toString(16)}toHumanizeString(){const e=this.rawAmount.times(10**-this.decimals),t=e.decimalPlaces();return e.decimalPlaces(t,S.BigNumber.ROUND_FLOOR).toFormat().toString()}}function P(e,t,i=t){if(!t||!i||t<=0||i<=0)throw new Error("start or end is invalid");return e.length<=t+i?e:e.slice(0,t)+"..."+e.slice(-i)}const C=/^0[xX][0-9a-fA-F]*$/;function E(e){return C.test(e)}var k=i(4);function U(){const e=v.useContainer(),{currentWallet:t}=m.useContainer(),[i]=w(),{cacheTx:n,clearTx:r}=O();return Object(x.a)((async i=>{if(null===t||void 0===t||!t.signer)throw new Error("exception: signer undefined");if(!e)throw new Error("exception: ckitProvider undefined");const s="function"===typeof i?await i(e,t.signer):i;if("UniPass"===t.descriptor.name){const e=l.AbstractTransactionBuilder.serde.serialize(s);n(JSON.stringify(e))}const a=await e.sendTransaction(await t.signer.seal(s));return"UniPass"===t.descriptor.name&&r(),{txHash:a}}),{onSuccess({txHash:e}){const t=i.nervosExploreTxUrlPrefix+e;_.a.success({title:"Tx sent",content:Object(k.jsxs)("p",{children:["The transaction was sent, check it in\xa0",Object(k.jsx)("a",{href:t,target:"_blank",rel:"noreferrer",children:"explorer"}),Object(k.jsxs)("details",{children:[Object(k.jsx)("summary",{children:"transaction id"}),e]})]})})},onError(e){const t=(n="message",null!=(i=e)&&"object"===typeof i&&n in i?String(e.message):"Unknown error");var i,n;_.a.error({title:"Tx failed",content:t,width:360})}})}const z=({children:e})=>{const[t,i]=Object(n.useState)(!1),{isInitialized:r,setCurrentWalletName:s}=m.useContainer(),{mutateAsync:a}=U(),{shouldLogin:c,cacheLogin:o,shouldSendTx:d,cachedTx:h}=O();return Object(n.useEffect)((()=>{(async()=>{if(c&&(s("UniPass"),o()),d){if(!r)return;if(!h)throw new Error("Could not find transaction to send");const e=l.AbstractTransactionBuilder.serde.deserialize(h);await a(e).catch((()=>i(!0)))}i(!0)})()}),[r]),t?Object(k.jsx)(k.Fragment,{children:e}):Object(k.jsx)(u.a,{})};var T=i(133),L=i(1221),I=i(1222),D=i(1224);const R=T.a.div.withConfig({displayName:"Styled__StyledCardWrapper",componentId:"sc-1skmmyb-0"})(["width:360px;padding:24px;margin-bottom:48px;border-radius:16px;background:#fff;box-shadow:3px 3px 8px rgba(0,0,0,0.08);"]);var B=i(1233),H=i(90),M=i(1231);const N=Object(p.a)((()=>{const{currentWallet:e,setModalVisible:t}=m.useContainer();return e?Object(k.jsx)(H.a,{size:"small",onClick:()=>t(!0),children:Object(k.jsxs)(M.b,{children:[j(e.descriptor.name),Object(k.jsx)(B.a,{})]})}):Object(k.jsx)(H.a,{size:"small",type:"primary",onClick:()=>t(!0),children:"Connect"})}));var V=i(148),W=i(175);function F(){const{mutateAsync:e}=U();return Object(x.a)(["sendIssueTx"],(async t=>{await e((async(e,i)=>{const n={recipient:t.recipient,amount:t.amount};"invite"===t.operationKind?(n.capacityPolicy="createCell",n.additionalCapacity=l.helpers.CkbAmount.fromCkb(1).toHex(),n.amount="0"):n.capacityPolicy="findAcp";return new l.MintSudtBuilder({recipients:[n]},e,await i.getAddress()).build()}))}))}function K(){const e=Object(n.useMemo)((()=>[{symbol:"ckb",decimal:8}]),[]),[t,i]=Object(d.useLocalStorage)("assetMeta",e),r=Object(n.useCallback)((e=>{i(t.concat(e))}),[t,i]);return{assetsMeta:t,addAssetMeta:r}}function Y(){const e=function(){const e=v.useContainer();if(!e)throw new Error("Cannot find provider, make suer useProvider in CkitProviderContainer");return e}(),t=Object(n.useCallback)((t=>{try{e.parseToScript(t)}catch(i){return"invalid ckb address"}}),[e]),i=Object(n.useCallback)((t=>{const i=e.config.SCRIPTS;return t.code_hash===i.ANYONE_CAN_PAY.CODE_HASH||t.code_hash===i.PW_ANYONE_CAN_PAY.CODE_HASH||t.code_hash===i.UNIPASS.CODE_HASH}),[e]),r=Object(n.useCallback)((n=>{const r=t(n);return r||(i(e.parseToScript(n))?void 0:"address not anyone can pay")}),[e,t,i]),s=Object(n.useCallback)((async(t,i)=>{const n=r(t);if(n)return n;return(await e.collectUdtCells(t,i,"0")).length>0?"user already invited":void 0}),[e,r]),a=Object(n.useCallback)((async(t,i)=>{const n=r(t);if(n)return n;return 0===(await e.collectUdtCells(t,i,"0")).length?"please invite first":void 0}),[e,r]),c=Object(n.useCallback)((async(t,i)=>{const n=r(t);if(n)return n;return 0===(await e.collectUdtCells(t,i,"0")).length?"no available acp sudt cell for recipient":void 0}),[e,r]),o=Object(n.useCallback)(((e,t)=>{const i=A.fromHumanize(e,t);return i.rawAmount.isNaN()?"invalid number":i.rawAmount.lt(1)?"at least issue one token":void 0}),[]);return{validateCkbAddress:t,validateInviteAddress:s,validateIssueAddress:a,validateTransferAddress:c,validateAmount:o}}const q=Object(p.a)((()=>{const{signerAddress:e,setModalVisible:t}=m.useContainer(),[i]=w();if(!e)return Object(k.jsx)(V.a,{});const n=P(e,8),r=i.nervosExploreAddressUrlPrefix+e;return Object(k.jsx)("div",{style:{marginTop:"32px",marginBottom:"32px"},children:Object(k.jsxs)(L.a,{children:[Object(k.jsx)(I.a,{span:8,offset:6,children:Object(k.jsx)("div",{style:{textAlign:"center"},children:Object(k.jsx)(W.a,{title:Object(k.jsx)(X,{copyable:!0,children:e}),children:Object(k.jsx)("a",{href:r,target:"_blank",rel:"noreferrer",children:n})})})}),Object(k.jsx)(I.a,{span:8,offset:2,children:Object(k.jsx)("div",{style:{float:"right"},children:Object(k.jsx)(H.a,{size:"small",onClick:()=>t(!0),children:"change"})})})]})})})),X=Object(T.a)(D.a.Text).withConfig({displayName:"WalletChange__AddressTip",componentId:"sc-1w8u2wj-0"})(["color:#ffffff;"]);var J=i(1234),Z=i(1235),G=i(1232);const $=T.a.div.withConfig({displayName:"WalletList__ModalBorderWrapper",componentId:"sc-w24eo8-0"})([".ant-list-item{padding:4px 0;margin:4px 0;border-radius:8px;border:1px solid rgba(0,0,0,0);&:hover{border:1px solid rgba(0,0,0,0.2);border-radius:8px;cursor:pointer;}}"]),Q=Object(p.a)((()=>{const{wallets:e,setCurrentWalletName:t,visible:i,setError:n,setModalVisible:r}=m.useContainer();return Object(k.jsx)(_.a,{closable:!0,title:"Choose wallets",width:312,visible:i,onCancel:()=>r(!1),footer:null,children:Object(k.jsx)($,{children:Object(k.jsx)(G.b,{pagination:!1,dataSource:e,renderItem:(e,i)=>Object(k.jsx)(G.b.Item,{onClick:()=>{n(null),"disconnected"===e.connectStatus&&e.connect(),"connected"===e.connectStatus&&(t(e.descriptor.name),r(!1))},children:Object(k.jsx)(ee,{wallet:e,index:i})})})})})})),ee=Object(p.a)((e=>{const{wallet:t,index:i}=e,{error:n}=m.useContainer();return"disconnected"===t.connectStatus?Object(k.jsxs)("div",{children:[Object(k.jsxs)(M.b,{children:[j(t.descriptor.name),Object(k.jsx)(J.a,{})]}),n&&n.index===i&&Object(k.jsxs)(D.a.Text,{type:"danger",children:[" ",n.error.message]})]}):"connecting"===t.connectStatus?Object(k.jsx)("div",{children:Object(k.jsxs)(M.b,{children:[j(t.descriptor.name),Object(k.jsx)(Z.a,{spin:!0})]})}):Object(k.jsx)("div",{children:Object(k.jsxs)(M.b,{children:[j(t.descriptor.name),Object(k.jsx)(B.a,{})]})})})),te=()=>Object(k.jsxs)(R,{children:[Object(k.jsx)("div",{style:{marginBottom:"24px"},children:Object(k.jsxs)(L.a,{children:[Object(k.jsx)(I.a,{span:12,children:Object(k.jsx)(D.a.Title,{level:3,children:" Account "})}),Object(k.jsx)(I.a,{span:12,children:Object(k.jsx)("div",{style:{float:"right",paddingTop:"5px"},children:Object(k.jsx)(N,{})})})]})}),Object(k.jsx)(Q,{}),Object(k.jsx)(q,{})]});var ie=i(1236),ne=i(1223),re=i(199),se=i(1229);const ae=e=>{const{script:t,decimal:i}=e,n=v.useContainer(),{signerAddress:r}=m.useContainer(),s=Object(se.a)(["queryBalance",{script:t,address:r}],(()=>{if(!n||!r)throw new Error("exception: signer should exist");return t?n.getUdtBalance(r,t):n.getCkbLiveCellsBalance(r)}),{enabled:!!r});return s.isError?Object(k.jsx)(D.a.Text,{type:"danger",children:"error"}):s.data?Object(k.jsx)(D.a.Text,{children:A.fromRaw(s.data,i).toHumanizeString()}):Object(k.jsx)(re.a,{})};var ce=i(1227),oe=i(255);const le=e=>{var t;const{script:i,decimal:r}=e,[s,a]=Object(n.useState)(!1),c=v.useContainer(),{signerAddress:o}=m.useContainer(),l=Object(n.useMemo)((()=>{if(!c)throw new Error("excepiton: provider undefined");if(!o)throw new Error("excepiton: signerAddress undefined");return c.newSudtScript(o)}),[c,o]),u=(null===(t=e.script)||void 0===t?void 0:t.code_hash)===l.code_hash&&e.script.hash_type===l.hash_type&&e.script.args===l.args,d=u?"mint":"send",h=Object(se.a)(["queryBalance",{script:i,address:o}],(()=>{if(!c||!o)throw new Error("exception: signer should exist");return i?c.getUdtBalance(o,i):c.getCkbLiveCellsBalance(o)}),{enabled:!!o}),p=!u&&(h.isLoading||h.isError||!h.data||A.fromRaw(h.data,r).rawAmount.eq(0));return Object(k.jsxs)("div",{children:[Object(k.jsx)(H.a,{type:"link",disabled:p,onClick:()=>a(!0),children:d}),Object(k.jsx)(ue,{visible:s,setVisible:a,assetMeta:e,isMint:u})]})},ue=e=>{const{visible:t,setVisible:i,assetMeta:r,isMint:s}=e,{validateCkbAddress:a,validateIssueAddress:c,validateTransferAddress:o,validateAmount:u}=Y(),{mutateAsync:d,isLoading:h}=function(){const{mutateAsync:e}=U();return Object(x.a)(["sendTransferTx"],(async t=>{await e((async(e,i)=>t.script?new l.AcpTransferSudtBuilder({recipients:[{recipient:t.recipient,sudt:t.script,amount:t.amount,policy:"findAcp"}]},e,await i.getAddress()).build():new l.TransferCkbBuilder({recipients:[{recipient:t.recipient,amount:t.amount,capacityPolicy:"createCell"}]},e,await i.getAddress()).build()))}))}(),{mutateAsync:p,isLoading:f}=F(),w=(s?"Mint ":"Send ")+r.symbol,v=Object(n.useCallback)((e=>{s?p({recipient:e.recipient,amount:A.fromHumanize(e.amount,r.decimal).toRawString(),operationKind:"issue"}).then((()=>i(!1))):d({recipient:e.recipient,amount:A.fromHumanize(e.amount,r.decimal).toRawString(),script:r.script}).then((()=>i(!1)))}),[s,p,d,r,i]),b=s?f:h,g=Object(oe.a)({initialValues:{recipient:"",amount:""},validate:async e=>{const t={};if(s){if(!r.script)throw new Error("exception: issued sudt should have script");const i=await c(e.recipient,r.script);i&&(t.recipient=i)}else if(r.script){const i=await o(e.recipient,r.script);i&&(t.recipient=i)}else{const i=await a(e.recipient);i&&(t.recipient=i)}e.recipient||(t.recipient="recipient required");const i=u(e.amount,r.decimal);return i&&(t.amount=i),e.amount||(t.amount="amount required"),t},onSubmit:v}),y=Object(n.useCallback)((()=>{g.resetForm(),i(!1)}),[g,i]);return Object(k.jsxs)(_.a,{title:w,closable:!0,width:312,visible:t,onCancel:y,footer:null,children:[Object(k.jsxs)("div",{children:[Object(k.jsxs)(L.a,{justify:"center",align:"middle",children:[Object(k.jsx)(I.a,{span:7,children:Object(k.jsx)("label",{htmlFor:"recipient",children:"recipient"})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsx)(ce.a,{id:"recipient",placeholder:"ckb address",...g.getFieldProps("recipient")})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:8,children:g.touched.recipient&&g.errors.recipient&&Object(k.jsx)(D.a.Text,{type:"danger",children:g.errors.recipient})})})]}),Object(k.jsxs)("div",{style:{marginTop:"24px"},children:[Object(k.jsxs)(L.a,{justify:"center",align:"middle",children:[Object(k.jsx)(I.a,{span:7,children:Object(k.jsx)("label",{htmlFor:"amount",children:"amount:"})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsx)(ce.a,{id:"amount",...g.getFieldProps("amount")})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:8,children:g.touched.amount&&g.errors.amount&&Object(k.jsx)(D.a.Text,{type:"danger",children:g.errors.amount})})})]}),Object(k.jsx)("div",{style:{marginTop:"30px",textAlign:"center"},children:Object(k.jsx)(H.a,{loading:b,onClick:g.submitForm,children:"submit"})})]})},de=()=>{const{assetsMeta:e}=K(),t=[{render:(e,t)=>Object(k.jsx)("div",{children:t.symbol})},{render:(e,t)=>Object(k.jsx)(ae,{decimal:t.decimal,script:t.script})},{render:(e,t)=>Object(k.jsx)(le,{symbol:t.symbol,decimal:t.decimal,script:t.script})}];return Object(k.jsx)("div",{children:Object(k.jsx)(ne.a,{size:"small",showHeader:!1,columns:t,dataSource:e,pagination:{pageSize:5}})})};var he=i(1225),pe=i(457);const fe=e=>{const{initialAssetMeta:t,buttonContent:i,...r}=e,[s,a]=Object(n.useState)(!1);return Object(k.jsxs)("div",{children:[Object(k.jsx)(H.a,{...r,onClick:()=>a(!0),children:i||""}),Object(k.jsx)(we,{visible:s,setVisible:a,initialAssetMeta:t})]})},we=e=>{const{visible:t,setVisible:i,initialAssetMeta:r}=e,{addAssetMeta:s}=K(),a={symbol:null!==r&&void 0!==r&&r.symbol?r.symbol:"",decimal:null!==r&&void 0!==r&&r.decimal?r.decimal:8,codeHash:null!==r&&void 0!==r&&r.codeHash?r.codeHash:"",hashType:null!==r&&void 0!==r&&r.hashType?r.hashType:"type",args:null!==r&&void 0!==r&&r.args?r.args:""},c=Object(oe.a)({initialValues:a,validate:e=>{const t={};return e.symbol||(t.symbol="symbol required"),e.decimal<=0&&(t.decimal="decimal should be greater than 0"),e.codeHash?E(e.codeHash)||(t.codeHash="code hash invalid hex string"):t.codeHash="code hash required",e.args?E(e.args)||(t.args="args invalid hex string"):t.args="args required",t},onSubmit:(e,{setSubmitting:t})=>{const n={symbol:e.symbol,decimal:e.decimal,script:{code_hash:e.codeHash,hash_type:e.hashType,args:e.args}};s(n),t(!1),i(!1)}}),o=Object(n.useCallback)((()=>{c.resetForm(),i(!1)}),[c,i]);return Object(k.jsxs)(_.a,{title:"Add asset",closable:!0,width:312,visible:t,onCancel:o,footer:null,children:[Object(k.jsxs)("div",{children:[Object(k.jsxs)(L.a,{align:"middle",children:[Object(k.jsx)(I.a,{span:8,children:Object(k.jsx)("label",{htmlFor:"symbol",children:"symbol:"})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsx)(ce.a,{id:"symbol",...c.getFieldProps("symbol")})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:8,children:c.touched.symbol&&c.errors.symbol&&Object(k.jsx)(D.a.Text,{type:"danger",children:c.errors.symbol})})})]}),Object(k.jsxs)("div",{style:{marginTop:"24px"},children:[Object(k.jsxs)(L.a,{align:"middle",children:[Object(k.jsx)(I.a,{span:8,children:Object(k.jsx)("label",{htmlFor:"decimal",children:"decimal:"})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsx)(he.a,{id:"decimal",onChange:e=>{c.setFieldValue("decimal",e,!0)},onBlur:c.handleBlur,value:c.values.decimal})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:8,children:c.touched.decimal&&c.errors.decimal&&Object(k.jsx)(D.a.Text,{type:"danger",children:c.errors.decimal})})})]}),Object(k.jsxs)("div",{style:{marginTop:"24px"},children:[Object(k.jsxs)(L.a,{align:"middle",children:[Object(k.jsx)(I.a,{span:8,children:Object(k.jsx)("label",{htmlFor:"codeHash",children:"code hash:"})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsx)(ce.a,{id:"codeHash",...c.getFieldProps("codeHash")})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:8,children:c.touched.codeHash&&c.errors.codeHash&&Object(k.jsx)(D.a.Text,{type:"danger",children:c.errors.codeHash})})})]}),Object(k.jsxs)("div",{style:{marginTop:"24px"},children:[Object(k.jsxs)(L.a,{align:"middle",children:[Object(k.jsx)(I.a,{span:8,children:Object(k.jsx)("label",{htmlFor:"hashType",children:"hash type:"})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsxs)(pe.a.Group,{id:"hashType",name:"hashType",onChange:c.handleChange,value:c.values.hashType,children:[Object(k.jsx)(pe.a,{value:"type",children:"type"}),Object(k.jsx)(pe.a,{value:"data",children:"data"})]})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:8,children:c.touched.hashType&&c.errors.hashType&&Object(k.jsx)(D.a.Text,{type:"danger",children:c.errors.hashType})})})]}),Object(k.jsxs)("div",{style:{marginTop:"24px"},children:[Object(k.jsxs)(L.a,{align:"middle",children:[Object(k.jsx)(I.a,{span:8,children:Object(k.jsx)("label",{htmlFor:"args",children:"args:"})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsx)(ce.a,{id:"args",...c.getFieldProps("args")})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:8,children:c.touched.args&&c.errors.args&&Object(k.jsx)(D.a.Text,{type:"danger",children:c.errors.args})})})]}),Object(k.jsx)("div",{style:{marginTop:"36px",textAlign:"center"},children:Object(k.jsx)(H.a,{onClick:c.submitForm,children:"submit"})})]})},ve=Object(p.a)((()=>{const{signerAddress:e}=m.useContainer();return Object(k.jsx)("div",{children:Object(k.jsxs)(R,{children:[Object(k.jsx)("div",{style:{marginBottom:"12px"},children:Object(k.jsxs)(L.a,{children:[Object(k.jsx)(I.a,{span:12,children:Object(k.jsx)(D.a.Title,{level:3,children:" Asset "})}),Object(k.jsx)(I.a,{span:12,children:Object(k.jsx)("div",{style:{float:"right"},children:e&&Object(k.jsx)(fe,{type:"link",size:"large",icon:Object(k.jsx)(ie.a,{style:{fontSize:"24px"}})})})})]})}),Object(k.jsxs)("div",{children:[e&&Object(k.jsx)(de,{}),!e&&Object(k.jsx)(V.a,{})]})]})})}));var be=i(114);const ge=e=>{const{symbol:t,decimal:i,script:n}=e,[r]=w(),s=be.utils.computeScriptHash(n);return Object(k.jsxs)("div",{style:{marginTop:"24px"},children:[Object(k.jsxs)(L.a,{children:[Object(k.jsx)(I.a,{span:7,offset:3,children:Object(k.jsx)(D.a.Text,{children:"symbol:"})}),Object(k.jsx)(I.a,{span:14,children:Object(k.jsx)(D.a.Text,{children:t})})]}),Object(k.jsxs)(L.a,{style:{marginTop:"8px"},children:[Object(k.jsx)(I.a,{span:7,offset:3,children:Object(k.jsx)(D.a.Text,{children:"decimal:"})}),Object(k.jsx)(I.a,{span:14,children:Object(k.jsx)(D.a.Text,{children:i})})]}),Object(k.jsxs)(L.a,{style:{marginTop:"8px"},children:[Object(k.jsx)(I.a,{span:7,offset:3,children:Object(k.jsx)(D.a.Text,{children:"script hash:"})}),Object(k.jsx)(I.a,{span:14,children:Object(k.jsx)(W.a,{title:Object(k.jsx)(ye,{copyable:!0,children:JSON.stringify(n)}),children:Object(k.jsx)(D.a.Link,{href:r.nervosExploreSudtUrlPrefix+s,target:"_blank",rel:"noreferrer",children:P(s,8)})})})]})]})},ye=Object(T.a)(D.a.Text).withConfig({displayName:"AssetMetaDisplay__ScriptTip",componentId:"sc-z5s62p-0"})(["color:#ffffff;"]),me=Object(p.a)((e=>{const{assetMeta:t}=e,[i,r]=Object(n.useState)(!1),[s,a]=Object(n.useState)("invite");return Object(k.jsxs)("div",{style:{marginBottom:"12px"},children:[Object(k.jsxs)(L.a,{children:[Object(k.jsx)(I.a,{span:4,offset:4,children:Object(k.jsx)(H.a,{onClick:()=>{a("invite"),r(!0)},children:"invite"})}),Object(k.jsx)(I.a,{span:4,offset:8,children:Object(k.jsx)(H.a,{onClick:()=>{a("issue"),r(!0)},children:"issue"})})]}),Object(k.jsx)(je,{visible:i,setVisible:r,operationKind:s,assetMeta:t})]})})),je=e=>{const{visible:t,setVisible:i,operationKind:r,assetMeta:s}=e,{validateInviteAddress:a,validateIssueAddress:c,validateAmount:o}=Y(),{mutateAsync:l,isLoading:u}=F(),d="invite"===r?"Invite user":"Issue "+s.symbol,h="invite"===r?"user:":"recipient:",p=Object(oe.a)({initialValues:{inviteRecipient:"",issueRecipient:"",amount:""},validate:async e=>{if(!s.script)throw new Error("exception: issued sudt should have script");const t={};if("invite"===r)if(e.inviteRecipient){const i=await a(e.inviteRecipient,s.script);i&&(t.inviteRecipient=i)}else t.inviteRecipient="recipient required";if("issue"===r){if(e.issueRecipient){const i=await c(e.issueRecipient,s.script);i&&(t.issueRecipient=i)}else t.issueRecipient="recipient required";if(e.amount){const i=o(e.amount,s.decimal);i&&(t.amount=i)}else t.amount="amount required"}return t},onSubmit:e=>{l({recipient:e.inviteRecipient,amount:A.fromHumanize(e.amount,s.decimal).toRawString(),operationKind:r}).then((()=>i(!1)))}}),f=Object(n.useCallback)((()=>{p.resetForm(),i(!1)}),[p,i]);return Object(k.jsxs)(_.a,{title:d,closable:!0,width:312,visible:t,onCancel:f,footer:null,children:["invite"===r&&Object(k.jsxs)("div",{children:[Object(k.jsxs)(L.a,{justify:"center",align:"middle",children:[Object(k.jsx)(I.a,{span:4,children:Object(k.jsx)("label",{htmlFor:"inviteRecipient",children:h})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsx)(ce.a,{id:"inviteRecipient",placeholder:"ckb address",...p.getFieldProps("inviteRecipient")})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:6,children:p.touched.inviteRecipient&&p.errors.inviteRecipient&&Object(k.jsx)(D.a.Text,{type:"danger",children:p.errors.inviteRecipient})})})]}),"issue"===r&&Object(k.jsxs)("div",{children:[Object(k.jsxs)("div",{children:[Object(k.jsxs)(L.a,{justify:"center",align:"middle",children:[Object(k.jsx)(I.a,{span:7,children:Object(k.jsx)("label",{htmlFor:"issueRecipient",children:h})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsx)(ce.a,{id:"issueRecipient",placeholder:"ckb address",...p.getFieldProps("issueRecipient")})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:8,children:p.touched.issueRecipient&&p.errors.issueRecipient&&Object(k.jsx)(D.a.Text,{type:"danger",children:p.errors.issueRecipient})})})]}),Object(k.jsxs)("div",{style:{marginTop:"24px"},children:[Object(k.jsxs)(L.a,{justify:"center",align:"middle",children:[Object(k.jsx)(I.a,{span:7,children:Object(k.jsx)("label",{htmlFor:"amount",children:"amount:"})}),Object(k.jsx)(I.a,{span:16,children:Object(k.jsx)(ce.a,{id:"amount",...p.getFieldProps("amount")})})]}),Object(k.jsx)(L.a,{children:Object(k.jsx)(I.a,{offset:8,children:p.touched.amount&&p.errors.amount&&Object(k.jsx)(D.a.Text,{type:"danger",children:p.errors.amount})})})]})]}),Object(k.jsx)("div",{style:{marginTop:"30px",textAlign:"center"},children:Object(k.jsx)(H.a,{loading:u,onClick:p.submitForm,children:"submit"})})]})},_e=e=>{const{issuerAddress:t}=e,i=v.useContainer(),{assetsMeta:r}=K(),s=Object(n.useMemo)((()=>{if(!i)throw new Error("excepiton: provider undefined");return i.newSudtScript(t)}),[i,t]),a=Object(n.useMemo)((()=>r.find((e=>{var t;return(null===(t=e.script)||void 0===t?void 0:t.hash_type)===s.hash_type&&e.script.code_hash===s.code_hash&&e.script.args===s.args}))),[s,r]),c=a?a.symbol:"?",o=a?a.decimal.toString():"?";return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(ge,{symbol:c,decimal:o,script:s}),Object(k.jsxs)("div",{style:{marginTop:"36px",textAlign:"center"},children:[!a&&Object(k.jsx)(fe,{type:"primary",buttonContent:"Add asset info",initialAssetMeta:{codeHash:s.code_hash,hashType:s.hash_type,args:s.args}}),a&&Object(k.jsx)(me,{assetMeta:a})]})]})},xe=Object(p.a)((()=>{const{currentWallet:e,signerAddress:t}=m.useContainer(),i=null===e||void 0===e?void 0:e.checkSupported("issue-sudt");return Object(k.jsx)("div",{children:i&&Object(k.jsxs)(R,{children:[Object(k.jsx)("div",{children:Object(k.jsx)(D.a.Title,{level:3,children:" Issue "})}),!t&&Object(k.jsx)(V.a,{}),t&&Object(k.jsx)(_e,{issuerAddress:t})]})})})),Oe=()=>Object(k.jsx)(Se,{children:Object(k.jsxs)("div",{className:"app",children:[Object(k.jsx)(te,{}),Object(k.jsx)(xe,{}),Object(k.jsx)(ve,{})]})}),Se=T.a.div.withConfig({displayName:"views__BodyWrapper",componentId:"sc-x3jvth-0"})(["padding-bottom:32px;min-height:100vh;background:linear-gradient(111.44deg,#a6ded2 0%,#8c99c2 100%);display:flex;align-items:center;justify-content:center;"]);i(1208);var Ae=()=>{const e=new c.a;return Object(k.jsx)(o.a,{client:e,children:Object(k.jsx)(v.Provider,{children:Object(k.jsx)(m.Provider,{children:Object(k.jsx)(z,{children:Object(k.jsx)(Oe,{})})})})})};var Pe=e=>{e&&e instanceof Function&&i.e(3).then(i.bind(null,1237)).then((({getCLS:t,getFID:i,getFCP:n,getLCP:r,getTTFB:s})=>{t(e),i(e),n(e),r(e),s(e)}))};a.a.render(Object(k.jsx)(r.a.StrictMode,{children:Object(k.jsx)(Ae,{})}),document.getElementById("root")),Pe()},138:function(e,t,i){"use strict";function n(e){throw new Error(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.unimplemented=function(){throw new Error("unimplemented")},t.asyncSleep=function(e){return new Promise((t=>setTimeout(t,e)))},t.randomHexString=function(e){return"0x"+[...Array(e)].map((()=>Math.floor(16*Math.random()).toString(16))).join("")},t.nonNullable=function(e){if(null==e)throw new Error("Null check failed");return e},t.bytesToHex=function(e){return"0x".concat([...e].map((e=>e.toString(16).padStart(2,"0"))).join(""))},t.hexToBytes=function(e){const t=(e=e.startsWith("0x")?e.slice(2):e).match(/.{1,2}/g);if(!t)throw new Error("cannot parse ".concat(e," into Uint8Array"));return Uint8Array.from(t.map((e=>parseInt(e,16))))},t.boom=n,t.asserts=function(e,t){if(e)return;if("function"===typeof t)throw t();"string"===typeof t&&n(t);if(t instanceof Error)throw t;n()}},150:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"debug",{enumerable:!0,get:function(){return n.debug}}),Object.defineProperty(t,"createDebugger",{enumerable:!0,get:function(){return n.createDebugger}}),Object.defineProperty(t,"invariant",{enumerable:!0,get:function(){return r.invariant}}),Object.defineProperty(t,"unimplemented",{enumerable:!0,get:function(){return s.unimplemented}}),t.bytes=void 0;var n=i(719),r=i(723),s=i(725),a=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var i=c(t);if(i&&i.has(e))return i.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=r?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=e[s]}n.default=e,i&&i.set(e,n);return n}(i(726));function c(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(c=function(e){return e?i:t})(e)}t.bytes=a},158:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"serialize",{enumerable:!0,get:function(){return r.serialize}}),Object.defineProperty(t,"deserialize",{enumerable:!0,get:function(){return r.deserialize}}),t.Pw=void 0;var n=i(21),r=i(1093);function s(e){return{code_hash:e.codeHash,args:e.args,hash_type:e.hashType}}function a(e){return new n.Script(e.code_hash,e.args,"type"===e.hash_type?n.HashType.type:n.HashType.data)}const c={fromPwCellDep:function(e){return{dep_type:e.depType,out_point:{tx_hash:e.outPoint.txHash,index:e.outPoint.index}}},toPwCellDep:function(e){return new n.CellDep("dep_group"===e.dep_type?n.DepType.depGroup:n.DepType.code,new n.OutPoint(e.out_point.tx_hash,e.out_point.index))},fromPwCell:function(e){return{cell_output:{capacity:e.capacity.toHexString(),type:e.type?s(e.type):void 0,lock:s(e.lock)},out_point:e.outPoint?{tx_hash:e.outPoint.txHash,index:e.outPoint.index}:void 0,data:e.getData()}},toPwCell:function(e){return function(e){return"object"===typeof e&&null!=e&&"cell_output"in e}(e)?new n.Cell(new n.Amount(e.cell_output.capacity,0),a(e.cell_output.lock),e.cell_output.type?a(e.cell_output.type):void 0,e.out_point?new n.OutPoint(e.out_point.tx_hash,e.out_point.index):void 0,e.data):new n.Cell(new n.Amount(e.output.capacity,0),a(e.output.lock),e.output.type?a(e.output.type):void 0,e.out_point?new n.OutPoint(e.out_point.tx_hash,e.out_point.index):void 0,e.output_data)},toPwScript:a,fromPwScript:s,toPwOutPoint:function(e){return new n.OutPoint(e.tx_hash,e.index)}};t.Pw=c},159:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecipientSameWithSenderError=t.NoEnoughUdtError=t.NoEnoughCkbError=t.NoAvailableCellError=t.CkitError=void 0;class n extends Error{constructor(e,t){super(t),this.metadata=e}}t.CkitError=n;t.NoAvailableCellError=class extends n{constructor(e,t="Cannot find available cell"){super(e,t)}};t.NoEnoughCkbError=class extends n{constructor(e,t="Ckb is not enough, expected minimal amount: ".concat(e.expected,", actual: ").concat(e.actual)){super(e,t)}};t.NoEnoughUdtError=class extends n{constructor(e,t="Udt is not enough, expected minimal amount: ".concat(e.expected,", actual: ").concat(e.actual)){super(e,t)}};t.RecipientSameWithSenderError=class extends n{constructor(e,t="The recipient and sender cannot be the same one"){super(e,t)}}},205:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ScriptManager",{enumerable:!0,get:function(){return n.ScriptManager}}),Object.defineProperty(t,"AbstractProvider",{enumerable:!0,get:function(){return r.AbstractProvider}}),Object.defineProperty(t,"ProviderConfig",{enumerable:!0,get:function(){return r.ProviderConfig}}),Object.defineProperty(t,"InitOptions",{enumerable:!0,get:function(){return r.InitOptions}}),Object.defineProperty(t,"AbstractWallet",{enumerable:!0,get:function(){return s.AbstractWallet}});var n=i(701),r=i(702),s=i(718)},212:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={SerializeRcLockWitnessLock:!0,SerializeUdtInfo:!0,UdtInfo:!0};Object.defineProperty(t,"SerializeRcLockWitnessLock",{enumerable:!0,get:function(){return r.SerializeRcLockWitnessLock}}),Object.defineProperty(t,"SerializeUdtInfo",{enumerable:!0,get:function(){return s.SerializeUdtInfo}}),Object.defineProperty(t,"UdtInfo",{enumerable:!0,get:function(){return s.UdtInfo}});var r=i(836),s=i(579),a=i(837);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===a[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))}))},215:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractTransactionBuilder=void 0;var n,r,s,a=i(158);class c{serialize(e){return c.serde.serialize(e)}}t.AbstractTransactionBuilder=c,s={serialize:e=>(0,a.serialize)(e),deserialize:e=>(0,a.deserialize)(e)},(r="serde")in(n=c)?Object.defineProperty(n,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):n[r]=s},280:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.byteLenOfSudt=function(e=20){return 40+e+1+32+32+1+16},t.byteLenOfCkbLiveCell=function(e=20){return 40+e+1},t.byteLenOfRcCell=function(e,t,i){return 40+e+1+(t?32+t+1:0)+i}},281:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractPwSenderBuilder=void 0;var n=i(212),r=i(21),s=i(99),a=i(659),c=i(158),o=i(138),l=i(1096);class u extends r.Builder{constructor(e){super(Number(e.config.MIN_FEE_RATE)),this.provider=e}getCellDepByKey(e){return"RC_LOCK"===e?[c.Pw.toPwCellDep(this.provider.getCellDep("RC_LOCK")),c.Pw.toPwCellDep(this.provider.getCellDep("SECP256K1_BLAKE160"))]:"SUDT"===e?[c.Pw.toPwCellDep(this.provider.getCellDep("SUDT"))]:"ANYONE_CAN_PAY"===e?[c.Pw.toPwCellDep(this.provider.getCellDep("ANYONE_CAN_PAY")),c.Pw.toPwCellDep(this.provider.getCellDep("SECP256K1_BLAKE160"))]:"UNIPASS"===e?(0,l.getCellDeps)("ckb"===this.provider.config.PREFIX):"PW_ANYONE_CAN_PAY"===e?[c.Pw.toPwCellDep(this.provider.getCellDep("PW_ANYONE_CAN_PAY")),c.Pw.toPwCellDep(this.provider.getCellDep("SECP256K1_BLAKE160"))]:"PW_NON_ANYONE_CAN_PAY"===e?[c.Pw.toPwCellDep(this.provider.getCellDep("PW_NON_ANYONE_CAN_PAY")),c.Pw.toPwCellDep(this.provider.getCellDep("SECP256K1_BLAKE160"))]:"SECP256K1_BLAKE160"===e?[c.Pw.toPwCellDep(this.provider.getCellDep("SECP256K1_BLAKE160"))]:[]}getCellDepByScript(e){if("0x00000000000000000000000000000000000000000000000000545950455f4944"===e.code_hash)return[];const t=(()=>{const t=Object.entries(this.provider.config.SCRIPTS).find((([,t])=>t.CODE_HASH===e.code_hash&&t.HASH_TYPE===e.hash_type));if(t)return t[0]})();if(!t)throw new Error("Unknown script, code_hash: ".concat(e.code_hash,", hash_type: ").concat(e.hash_type));return this.getCellDepByKey(t)}getCellDeps(e=[]){return(0,a.uniqWith)(e.flatMap((e=>this.getCellDepByScript(e))),((e,t)=>e.sameWith(t)))}getCellDepsByCells(e,t){const i=e.flatMap((e=>e.type?[e.lock.serializeJson(),e.type.serializeJson()]:[e.lock.serializeJson()])),n=t.flatMap((e=>e.type?[e.type.serializeJson()]:[]));return this.getCellDeps(i.concat(n))}getWitnessPlaceholder(e){const t=(e,t)=>{const i=this.provider.parseToScript(t),n=this.provider.getScriptConfig(e);return n.CODE_HASH===i.code_hash&&n.HASH_TYPE===i.hash_type};if(t("SECP256K1_BLAKE160",e))return{lock:"0x"+"0".repeat(130),input_type:"",output_type:""};if(t("PW_NON_ANYONE_CAN_PAY",e))return{lock:"0x"+"0".repeat(132),input_type:"",output_type:""};if(t("PW_NON_ANYONE_CAN_PAY",e))return{lock:"0x"+"0".repeat(132),input_type:"",output_type:""};if(t("ANYONE_CAN_PAY",e))return{lock:"0x"+"0".repeat(130),input_type:"",output_type:""};if(t("UNIPASS",e))return{lock:"0x"+"0".repeat(2082),input_type:"",output_type:""};if(t("RC_LOCK",e)){const e=(0,n.SerializeRcLockWitnessLock)({signature:new s.Reader("0x"+"0".repeat(130))}).byteLength;return{lock:"0x"+"0".repeat(2*e),input_type:"",output_type:""}}(0,o.boom)("Unsupported lock ".concat(e))}}t.AbstractPwSenderBuilder=u},282:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractSingleEntrySigner=void 0;var n=i(21),r=i(1107);t.AbstractSingleEntrySigner=class{constructor(e){var t,i,s,a;a=void 0,(s="adapter")in(i=this)?Object.defineProperty(i,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):i[s]=a;const c=null!==(t=e.hasher)&&void 0!==t?t:new n.Blake2bHasher;this.adapter=new r.PwAdapterSigner(this,e.provider,c)}async seal(e){const t=await this.adapter.sign(e);return n.transformers.TransformTransaction(t)}}},298:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(525);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}));var r=i(717);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}))},507:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(1104);Object.keys(n).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===n[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return n[e]}}))}))},508:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect=f,t.hashMessage=b,t.InternalNonAcpPwLockSigner=t.NonAcpPwLockWallet=t.AcpPwLockWallet=void 0;var n,r=i(469),s=i(205),a=i(21),c=(n=i(1108))&&n.__esModule?n:{default:n},o=i(391),l=i(138),u=i(282);function d(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,p(e,t,"get"))}function h(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=i}}(e,p(e,t,"set"),i),i}function p(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return t.get(e)}function f(){return(0,c.default)().then((()=>window.ethereum))}class w extends s.AbstractWallet{constructor(e){super(),this.ckitProvider=e,function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"listener",(e=>{Array.isArray(e)&&(0!==e.length?this.emitChangedSigner(this.produceSigner()):this.emitConnectStatusChanged("disconnected"))})),this.setDescriptor({features:this.describeFeatures(),description:"Interacting with CKB via MetaMask",name:"NonAcpPwLockWallet"})}disconnect(){f().then((e=>e.removeEventListener("accountsChanged",this.listener))).then((()=>super.disconnect()))}async tryConnect(){const e=await f();return e.addListener("accountsChanged",this.listener),e.enable().then((()=>this.produceSigner()))}}class v extends u.AbstractSingleEntrySigner{constructor(e){super({provider:e}),this.ckitProvider=e}async signMessage(e){const t=await f(),i=t.selectedAddress,n=await t.request({method:"personal_sign",params:[i,e]});let r=Number.parseInt(n.slice(-2),16);return r>=27&&(r-=27),"0x"+a.Platform.eth.toString(16).padStart(2,"0")+n.slice(2,-2)+r.toString(16).padStart(2,"0")}}t.AcpPwLockWallet=class extends w{produceSigner(){return new class extends v{async getAddress(){const e=this.ckitProvider.getScriptConfig("PW_ANYONE_CAN_PAY");return this.ckitProvider.parseToAddress({hash_type:e.HASH_TYPE,args:(await f()).selectedAddress,code_hash:e.CODE_HASH})}}(this.ckitProvider)}describeFeatures(){return["acp"]}};function b(e){return(new a.Keccak256Hasher).update("\x19Ethereum Signed Message:\n32").update((0,l.hexToBytes)(e).buffer).digest().serializeJson()}t.NonAcpPwLockWallet=class extends w{produceSigner(){return new class extends v{async getAddress(){const e=this.ckitProvider.getScriptConfig("PW_NON_ANYONE_CAN_PAY");return this.ckitProvider.parseToAddress({hash_type:e.HASH_TYPE,args:(await f()).selectedAddress,code_hash:e.CODE_HASH})}}(this.ckitProvider)}describeFeatures(){return["issue-sudt"]}};var g=new WeakMap;class y extends u.AbstractSingleEntrySigner{constructor(e,t){super({provider:t}),this.ckitProvider=t,g.set(this,{writable:!0,value:void 0}),h(this,g,e)}getEthAddress(){const e=(0,o.publicKeyCreate)((0,l.hexToBytes)(d(this,g)),!1).slice(1);return"0x"+(new a.Keccak256Hasher).update(e.buffer).digest().serializeJson().slice(-40)}async getAddress(){const e=this.ckitProvider.getScriptConfig("PW_NON_ANYONE_CAN_PAY");return this.ckitProvider.parseToAddress({code_hash:e.CODE_HASH,hash_type:e.HASH_TYPE,args:this.getEthAddress()})}async signMessage(e){const t=r.key.signRecoverable(b(e),d(this,g));let i=Number.parseInt(t.slice(-2),16);i>=27&&(i-=27);return"0x"+a.Platform.eth.toString(16).padStart(2,"0")+t.slice(2,-2)+i.toString(16).padStart(2,"0")}}t.InternalNonAcpPwLockSigner=y},525:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.startsWith0x=r,t.rm0x=s,t.pad0x=a,t.safePadZero=c,t.prependZeroToEvenLength=o,t.convertEndian=l,t.formatByteLike=u,t.toUnfixedBuffer=d,t.toFixedBuffer=h,t.toBuffer=function(e,t){return void 0===t?d(e):h(e,t)},t.pipe=void 0;var n=i(13);function r(e){return"string"===typeof e&&e.startsWith("0x")}function s(e){return r(e)?e.slice(2):e}function a(e){return r(e)?e:"0x"+e}function c(e,t,i){const n=e.length%2===0,r=void 0===i;if(n&&r)return e;const s=n?0:1,a=2*(r?(e.length+s)/2:i);return t?e.slice(0,a).padEnd(a,"0"):e.slice(-a).padStart(a,"0")}function o(e){return e.length%2===0?e:"0".concat(e)}function l(e){if(!e||e.length<2)return e;return o(e).match(/../g).reverse().join("")}function u(e,t={}){let i;i="string"===typeof e?s(e):n.Buffer.from(e).toString("hex"),i=c(i,t.le,t.byteSize);const o=!t.rm0x&&(t.pad0x||r(e));return t.convertEndian&&(i=l(i)),o&&(i=a(i)),i}function d(e){return n.Buffer.isBuffer(e)||e instanceof Uint8Array?n.Buffer.from(e):n.Buffer.from(u(e,{rm0x:!0}),"hex")}function h(e,t){if(0===t)return n.Buffer.from([]);const i=d(e),r=i.length;return 0===r?n.Buffer.alloc(t):r===t?i:r>t?i.slice(r-t):n.Buffer.concat([n.Buffer.alloc(t-r),i])}t.pipe=(...e)=>1===e.length?e[0]:e.reduce(((e,t)=>i=>t(e(i))))},579:function(e,t,i){"use strict";function n(e,t){throw new Error("Invalid data length! Required: ".concat(t,", actual: ").concat(e))}function r(e,t){e!==t&&n(e,t)}function s(e){if(e instanceof Object&&e.toArrayBuffer instanceof Function&&(e=e.toArrayBuffer()),!(e instanceof ArrayBuffer))throw new Error("Provided value must be an ArrayBuffer or can be transformed into ArrayBuffer!");return e}function a(e,t,i){e.byteLength<4&&n(e.byteLength,">4");const s=e.getUint32(0,!0);if(r(e.byteLength,s),4===s)return[s];s<8&&n(e.byteLength,">8");const a=e.getUint32(4,!0);if(a%4!==0||a<8)throw new Error("Invalid first offset: ".concat(a));const c=a/4-1;if(c<t)throw new Error("Item count not enough! Required: ".concat(t,", actual: ").concat(c));if(!i&&c>t)throw new Error("Item count is more than required! Required: ".concat(t,", actual: ").concat(c));if(s<a)throw new Error("First offset is larger than byte length: ".concat(a));const o=[];for(let n=0;n<c;n++){const t=4+4*n;o.push(e.getUint32(t,!0))}o.push(s);for(let n=0;n<o.length-1;n++)if(o[n]>o[n+1])throw new Error("Offset index ".concat(n,": ").concat(o[n]," is larger than offset index ").concat(n+1,": ").concat(o[n+1]));return o}function c(e){const t=e.length;let i=4*(t+1);const n=[];for(let c=0;c<t;c++)n.push(i),i+=e[c].byteLength;const r=new ArrayBuffer(i),s=new Uint8Array(r),a=new DataView(r);a.setUint32(0,i,!0);for(let c=0;c<t;c++)a.setUint32(4+4*c,n[c],!0),s.set(new Uint8Array(e[c]),n[c]);return r}Object.defineProperty(t,"__esModule",{value:!0}),t.SerializeUTF8Bytes=l,t.SerializeUint128=d,t.SerializeByte32=p,t.SerializeUdtInfo=w,t.SerializeUdtCellData=function(e){const t=[],i=new DataView(new ArrayBuffer(1));return i.setUint8(0,e.version),t.push(i.buffer),t.push(d(e.current_supply)),t.push(d(e.max_supply)),t.push(p(e.sudt_script_hash)),t.push(w(e.udt_info)),c(t)},t.UdtCellData=t.UdtInfo=t.Byte32=t.Uint128=t.UTF8Bytes=void 0;class o{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&n(this.view.byteLength,">4");const t=this.length()+4;r(this.view.byteLength,t)}raw(){return this.view.buffer.slice(4)}indexAt(e){return this.view.getUint8(4+e)}length(){return this.view.getUint32(0,!0)}}function l(e){const t=s(e),i=new Uint8Array(4+t.byteLength);return new DataView(i.buffer).setUint32(0,t.byteLength,!0),i.set(new Uint8Array(t),4),i.buffer}t.UTF8Bytes=o;class u{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){r(this.view.byteLength,16)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 16}}function d(e){const t=s(e);return r(t.byteLength,16),t}t.Uint128=u;class h{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){r(this.view.byteLength,32)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 32}}function p(e){const t=s(e);return r(t.byteLength,32),t}t.Byte32=h;class f{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);if(t[1]-t[0]!==1)throw new Error("Invalid offset for decimals: ".concat(t[0]," - ").concat(t[1]));new o(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new o(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate(),new o(this.view.buffer.slice(t[3],t[4]),{validate:!1}).validate()}getDecimals(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new DataView(this.view.buffer.slice(e,t)).getUint8(0)}getName(){const e=this.view.getUint32(8,!0),t=this.view.getUint32(12,!0);return new o(this.view.buffer.slice(e,t),{validate:!1})}getSymbol(){const e=this.view.getUint32(12,!0),t=this.view.getUint32(16,!0);return new o(this.view.buffer.slice(e,t),{validate:!1})}getDescription(){const e=this.view.getUint32(16,!0),t=this.view.byteLength;return new o(this.view.buffer.slice(e,t),{validate:!1})}}function w(e){const t=[],i=new DataView(new ArrayBuffer(1));return i.setUint8(0,e.decimals),t.push(i.buffer),t.push(l(e.name)),t.push(l(e.symbol)),t.push(l(e.description)),c(t)}t.UdtInfo=f;t.UdtCellData=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);if(t[1]-t[0]!==1)throw new Error("Invalid offset for version: ".concat(t[0]," - ").concat(t[1]));new u(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new u(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate(),new h(this.view.buffer.slice(t[3],t[4]),{validate:!1}).validate(),new f(this.view.buffer.slice(t[4],t[5]),{validate:!1}).validate()}getVersion(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new DataView(this.view.buffer.slice(e,t)).getUint8(0)}getCurrentSupply(){const e=this.view.getUint32(8,!0),t=this.view.getUint32(12,!0);return new u(this.view.buffer.slice(e,t),{validate:!1})}getMaxSupply(){const e=this.view.getUint32(12,!0),t=this.view.getUint32(16,!0);return new u(this.view.buffer.slice(e,t),{validate:!1})}getSudtScriptHash(){const e=this.view.getUint32(16,!0),t=this.view.getUint32(20,!0);return new h(this.view.buffer.slice(e,t),{validate:!1})}getUdtInfo(){const e=this.view.getUint32(20,!0),t=this.view.byteLength;return new f(this.view.buffer.slice(e,t),{validate:!1})}}},60:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={helpers:!0,errors:!0,utils:!0,predefined:!0};Object.defineProperty(t,"predefined",{enumerable:!0,get:function(){return d.predefined}}),t.utils=t.errors=t.helpers=void 0;var r=i(205);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===r[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}}))}));var s=i(727);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var a=i(1113);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===a[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))}));var c=i(658);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===c[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var o=p(i(507));t.helpers=o;var l=p(i(159));t.errors=l;var u=p(i(138));t.utils=u;var d=i(1129);function h(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(h=function(e){return e?i:t})(e)}function p(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==typeof e&&"function"!==typeof e)return{default:e};var i=h(t);if(i&&i.has(e))return i.get(e);var n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var a=r?Object.getOwnPropertyDescriptor(e,s):null;a&&(a.get||a.set)?Object.defineProperty(n,s,a):n[s]=e[s]}return n.default=e,i&&i.set(e,n),n}},658:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={AbstractTransactionBuilder:!0,SerializedTx:!0,DeserializedTx:!0};Object.defineProperty(t,"AbstractTransactionBuilder",{enumerable:!0,get:function(){return r.AbstractTransactionBuilder}}),Object.defineProperty(t,"SerializedTx",{enumerable:!0,get:function(){return r.SerializedTx}}),Object.defineProperty(t,"DeserializedTx",{enumerable:!0,get:function(){return r.DeserializedTx}});var r=i(215),s=i(1094);Object.keys(s).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===s[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return s[e]}}))}));var a=i(1097);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===a[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}}))}));var c=i(1099);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===c[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var o=i(1101);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===o[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}}))}))},660:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MercuryProvider=void 0;var n=i(1114),r=i(205),s=i(1115),a=i(150),c=i(21),o=i(399),l=i(159),u=i(507),d=i(138),h=i(1127);function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class f extends r.AbstractProvider{constructor(e="http://127.0.0.1:8116",t="http://127.0.0.1:8114"){super(),p(this,"mercury",void 0),p(this,"rpc",void 0),e instanceof s.MercuryClient?this.mercury=e:this.mercury=new s.MercuryClient(e),t instanceof n.RPC?this.rpc=t:this.rpc=new n.RPC(t)}async collectCkbLiveCells(e,t){const i=this.parseToScript(e),n={script:i,script_type:"lock",filter:{output_data_len_range:["0x0","0x1"]}},r=(0,o.from)(this.mercury.get_cells({search_key:n})).pipe((0,o.expand)((e=>this.mercury.get_cells({search_key:n,after_cursor:e.last_cursor})),1),(0,o.takeWhile)((e=>e.objects.length>0)),(0,o.concatMap)((e=>e.objects)),(0,o.filter)((e=>null==e.output.type)),(0,o.scan)(((e,t)=>({cells:e.cells.concat(t),amount:e.amount+BigInt(t.output.capacity)})),{amount:0n,cells:[]}),(0,o.takeWhile)((e=>e.amount<BigInt(t)),!0)),s=await(0,o.lastValueFrom)(r,{defaultValue:{amount:0n,cells:[]}});if(s.amount<BigInt(t))throw new l.NoEnoughCkbError({lock:i,expected:t,actual:u.Amount.from(s.amount).toHex()});return s.cells}async getCkbLiveCellsBalance(e){const t={script:this.parseToScript(e),script_type:"lock",filter:{output_data_len_range:["0x0","0x1"]}},i=(0,o.from)(this.mercury.get_cells({search_key:t})).pipe((0,o.expand)((e=>this.mercury.get_cells({search_key:t,after_cursor:e.last_cursor})),1),(0,o.takeWhile)((e=>e.objects.length>0)),(0,o.concatMap)((e=>e.objects)),(0,o.filter)((e=>null==e.output.type)),(0,o.reduce)(((e,t)=>e+BigInt(t.output.capacity)),0n)),n=await(0,o.lastValueFrom)(i,{defaultValue:"0x0"});return a.bytes.toHex(n)}getTxPoolInfo(){return this.rpc.tx_pool_info()}getChainInfo(){return this.rpc.get_blockchain_info()}sendTransaction(e){return this.rpc.send_transaction(e)}async collectUdtCells(e,t,i){const n=this.parseToScript(e),r={script:n,filter:{script:t},script_type:"lock"},s=(0,o.from)(this.mercury.get_cells({search_key:r})).pipe((0,o.expand)((e=>this.mercury.get_cells({search_key:r,after_cursor:e.last_cursor})),1),(0,o.takeWhile)((e=>e.objects.length>0)),(0,o.concatMap)((e=>e.objects)),(0,o.scan)(((e,t)=>({cells:e.cells.concat(t),amount:e.amount+BigInt((0,c.toBigUInt128LE)(t.output_data.slice(0,34)))})),{amount:0n,cells:[]}),(0,o.takeWhile)((e=>e.amount<BigInt(i)),!0)),a=await(0,o.lastValueFrom)(s,{defaultValue:{amount:0n,cells:[]}});if(a.amount<BigInt(i))throw new l.NoEnoughUdtError({lock:n,expected:i,actual:u.Amount.from(a.amount).toHex()});return a.cells}getUdtBalance(e,t){const i={script:this.parseToScript(e),filter:{script:t},script_type:"lock"},n=(0,o.from)(this.mercury.get_cells({search_key:i})).pipe((0,o.expand)((e=>this.mercury.get_cells({search_key:i,after_cursor:e.last_cursor})),1),(0,o.takeWhile)((e=>e.objects.length>0)),(0,o.concatMap)((e=>e.objects)),(0,o.reduce)(((e,t)=>e+BigInt((0,c.toBigUInt128LE)(t.output_data.slice(0,34)))),0n));return(0,o.lastValueFrom)(n,{defaultValue:0n}).then((e=>a.bytes.toHex(e)))}async waitForTransactionCommitted(e,t={}){const{pollIntervalMs:i=1e3,timeoutMs:n=12e4}=t,r=Date.now();let s=null;for(;Date.now()-r<=n;){var a;const t=await this.rpc.get_transaction(e);if("committed"===(null===t||void 0===t||null===(a=t.tx_status)||void 0===a?void 0:a.status)){s=t.transaction;break}await(0,d.asyncSleep)(i)}const c=Number(await this.rpc.get_tip_block_number());for(;Date.now()-r<=n;){const e=await this.mercury.get_tip();if(Number(e.block_number)>=c)break;await(0,d.asyncSleep)(i)}return s}asIndexerCellProvider(){return new h.MercuryCellProvider(this.mercury)}}t.MercuryProvider=f},700:function(e,t,i){},701:function(e,t,i){},702:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractProvider=void 0;var n=i(297),r=i(704),s=i(716);function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}t.AbstractProvider=class{constructor(){a(this,"initialized",!1),a(this,"_config",void 0)}get config(){if(!this._config)throw new Error("Cannot find the config, maybe provider is not initialied");return this._config}getScriptConfig(e){return this.config.SCRIPTS[e]}newScript(e,t){const i=this.getScriptConfig(e);if(i)return{code_hash:i.CODE_HASH,args:t,hash_type:i.HASH_TYPE}}newTypeIdScript(e){return{code_hash:"0x00000000000000000000000000000000000000000000000000545950455f4944",hash_type:"type",args:e}}generateTypeIdScript(e,t){return(0,s.generateTypeIdScript)(e,t)}getCellDep(e){const t=this.getScriptConfig(e);if(t)return{dep_type:t.DEP_TYPE,out_point:{tx_hash:t.TX_HASH,index:t.INDEX}}}findCellDepByAddress(e){const t=this.parseToScript(e),i=Object.values(this.config.SCRIPTS);if(null==i)return;const n=i.findIndex((e=>(null===e||void 0===e?void 0:e.CODE_HASH)===t.code_hash&&(null===e||void 0===e?void 0:e.HASH_TYPE)===t.hash_type)),r=i[n];return r?{dep_type:r.DEP_TYPE,out_point:{tx_hash:r.TX_HASH,index:r.INDEX}}:void 0}findCellDepByScript(e){return this.findCellDepByAddress(this.parseToAddress(e))}async init(e){if(!this.initialized){if(e){const t=e.MIN_FEE_RATE?e.MIN_FEE_RATE:(await this.getTxPoolInfo()).min_fee_rate;this._config={...e,MIN_FEE_RATE:t}}else{const e="ckb"===(await this.getChainInfo()).chain,t=await this.getTxPoolInfo();this._config=e?{...n.predefined.LINA,MIN_FEE_RATE:t.min_fee_rate}:{...n.predefined.AGGRON4,MIN_FEE_RATE:t.min_fee_rate}}this.initialized=!0}}parseToAddress(e){return(0,r.generateAddress)(e,{config:this.config})}parseToScript(e){return(0,r.parseAddress)(e,{config:this.config})}}},716:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateTypeIdScript=function(e,t){return{code_hash:"0x00000000000000000000000000000000000000000000000000545950455f4944",hash_type:"type",args:c(e,t)}};var n=i(114),r=i(298),s=i(99);function a(e){e=BigInt(e);const t=(0,r.toBuffer)("",8);return t.writeBigUInt64LE(e),function(e){const t=new ArrayBuffer(e.length),i=new Uint8Array(t);for(let n=0;n<e.length;++n)i[n]=e[n];return t}(t)}function c(e,t){const i=n.core.SerializeCellInput(s.normalizers.NormalizeCellInput(e)),r=a(t),c=new n.utils.CKBHasher;return c.update(i),c.update(r),c.digestHex()}},717:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createField=o,t.createFixedStruct=function(){return new l},t.U128BE=t.U128LE=t.I128BE=t.I128LE=t.U64BE=t.U64LE=t.I64BE=t.I64LE=t.U32BE=t.U32LE=t.I32BE=t.I32LE=t.U16BE=t.U16LE=t.I16BE=t.I16LE=t.U8=t.I8=t.FixedStruct=void 0;var n=i(13),r=i(525);function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e){return function(t,i=0){return t[e](i)}}function c(e){return function(t,i,n=0){t[e](i,n)}}function o(e,t,i){return{byteWidth:e,read:t,write:i}}class l{constructor(e=[]){s(this,"fields",void 0),s(this,"byteWidth",void 0),this.fields=e,this.byteWidth=e.reduce(((e,t)=>e+t[1].byteWidth),0)}field(e,t){const i=[e,t];return new l(this.fields.concat([i]))}decode(e){const t={};let i=0;return this.fields.forEach((([n,r])=>{const s=r.read(e,i);i+=r.byteWidth,t[n]=s})),t}encode(e){const t=this.fields.reduce(((e,[,t])=>t.byteWidth+e),0),i=n.Buffer.alloc(t);let r=0;return this.fields.forEach((([t,n])=>{n.write(i,e[t],r),r+=n.byteWidth})),i}}function u(e,t,i){return function(n,s=0){const a=(0,r.formatByteLike)(n.slice(s,s+e),{byteSize:e,convertEndian:t,pad0x:!0}),c=BigInt(a);if(!i)return c;const o=1n<<BigInt(8*e-1);return 0n===(o&c)?c:(o-1n&c)-o}}function d(e,t,i){return function(n,s,a=0){let c=s;i&&c<0n&&(c=(1n<<BigInt(8*e))+c);const o=(0,r.formatByteLike)(c.toString(16),{byteSize:e,convertEndian:t});n.write(o,a,"hex")}}t.FixedStruct=l;const h=o(1,a("readInt8"),c("writeInt8"));t.I8=h;const p=o(1,a("readUInt8"),c("writeUInt8"));t.U8=p;const f=o(2,a("readInt16LE"),c("writeInt16LE"));t.I16LE=f;const w=o(2,a("readInt16BE"),c("writeInt16BE"));t.I16BE=w;const v=o(2,a("readUInt16LE"),c("writeUInt16LE"));t.U16LE=v;const b=o(2,a("readUInt16BE"),c("writeUInt16BE"));t.U16BE=b;const g=o(4,a("readInt32LE"),c("writeInt32LE"));t.I32LE=g;const y=o(4,a("readInt32BE"),c("writeInt32BE"));t.I32BE=y;const m=o(4,a("readUInt32LE"),c("writeUInt32LE"));t.U32LE=m;const j=o(4,a("readUInt32BE"),c("writeUInt32BE"));t.U32BE=j;const _=o(8,a("readBigInt64LE"),c("writeBigInt64LE"));t.I64LE=_;const x=o(8,a("readBigInt64BE"),c("writeBigInt64BE"));t.I64BE=x;const O=o(8,a("readBigUInt64LE"),c("writeBigUInt64LE"));t.U64LE=O;const S=o(8,a("readBigUInt64BE"),c("writeBigUInt64BE"));t.U64BE=S;const A=o(16,u(16,!0,!0),d(16,!0,!0));t.I128LE=A;const P=o(16,u(16,!1,!0),d(16,!1,!0));t.I128BE=P;const C=o(16,u(16,!0,!1),d(16,!0,!1));t.U128LE=C;const E=o(16,u(16,!1,!1),d(16,!1,!1));t.U128BE=E},718:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractWallet=void 0;var n,r=i(150),s=(n=i(299))&&n.__esModule?n:{default:n};function a(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}t.AbstractWallet=class{constructor(){a(this,"descriptor",{name:"Unknown Wallet",features:[],description:"an unknown wallet"}),a(this,"connectStatus","disconnected"),a(this,"signer",void 0),a(this,"emitter",void 0),a(this,"on",((e,t)=>{this.emitter.on(e,t)})),this.emitter=new s.default}connect(){const e="disconnected"===this.connectStatus;(0,r.invariant)(e,"[".concat(this.descriptor.name,"]: Do not reconnect the wallet")),e&&(this.emitConnectStatusChanged("connecting"),this.tryConnect().then((e=>{this.emitConnectStatusChanged("connected"),this.emitChangedSigner(e)}),(e=>{this.emitError(e),this.emitConnectStatusChanged("disconnected")})))}disconnect(){this.emitConnectStatusChanged("disconnected"),this.emitter.removeAllListeners()}checkSupported(e){return this.descriptor.features.includes(e)}getConnectStatus(){return this.connectStatus}getSigner(){return this.signer}emitConnectStatusChanged(e){this.connectStatus=e,this.emitter.emit("connectStatusChanged",e)}emitChangedSigner(e){this.signer=e,this.emitter.emit("signerChanged",e)}emitError(e=new Error("An unknown error occurred in the ".concat(this.descriptor.name))){this.emitter.emit("error",e)}setDescriptor(e){const{name:t=this.descriptor.name,features:i=this.descriptor.features,description:n=this.descriptor.description}=e;this.descriptor={name:t,features:i,description:n}}}},719:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createDebugger=function(e){e.startsWith("ckit-")||(e="ckit-"+e);return(0,r.default)(e)},t.debug=void 0;var n,r=(n=i(720))&&n.__esModule?n:{default:n};const s=(0,r.default)("ckit");t.debug=s},723:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"invariant",{enumerable:!0,get:function(){return r.default}});var n,r=(n=i(724))&&n.__esModule?n:{default:n}},725:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unimplemented=function(){throw new Error("unimplemented")}},726:function(e,t,i){"use strict";(function(e){function i(e){return(e=n(r(e))).length%2!==0&&(e="0"+e),e}function n(e){return e.startsWith("0x")&&(e=e.slice(2)),e}function r(t){if("number"===typeof t){if(t<0||!Number.isInteger(t))throw new Error("Cannot parse ".concat(t," to a hex string"));return"0x"+t.toString(16)}if("string"===typeof t)return t.startsWith("0x")?t:"0x"+t;if("bigint"===typeof t)return"0x"+t.toString(16);if(e.isBuffer(t))return"0x"+t.toString("hex");throw new Error("Cannot parse ".concat(t," to a hex string"))}Object.defineProperty(t,"__esModule",{value:!0}),t.concat=function(...e){return"0x"+e.map(i).join("")},t.rm0x=n,t.toHex=r}).call(this,i(13).Buffer)},727:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={internal:!0,AcpPwLockWallet:!0,NonAcpPwLockWallet:!0,RcOwnerWallet:!0,RcPwSigner:!0};Object.defineProperty(t,"AcpPwLockWallet",{enumerable:!0,get:function(){return a.AcpPwLockWallet}}),Object.defineProperty(t,"NonAcpPwLockWallet",{enumerable:!0,get:function(){return a.NonAcpPwLockWallet}}),Object.defineProperty(t,"RcOwnerWallet",{enumerable:!0,get:function(){return o.RcOwnerWallet}}),Object.defineProperty(t,"RcPwSigner",{enumerable:!0,get:function(){return o.RcPwSigner}}),t.internal=void 0;var r=i(728),s=i(1109),a=i(508),c=i(1110);Object.keys(c).forEach((function(e){"default"!==e&&"__esModule"!==e&&(Object.prototype.hasOwnProperty.call(n,e)||e in t&&t[e]===c[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return c[e]}}))}));var o=i(1112);const l={RcSecp256k1Signer:r.RcSecp256k1Signer,Secp256k1Signer:s.Secp256k1Signer,RcEthSigner:r.RcEthSigner};t.internal=l},728:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RcEthSigner=t.RCLockSigner=t.RC_MODE=t.RcSecp256k1Signer=void 0;var n=i(469),r=i(212),s=i(150),a=i(21),c=i(99),o=i(391),l=i(658),u=i(138),d=i(282),h=i(508);function p(e,t){return function(e,t){if(t.get)return t.get.call(e);return t.value}(e,w(e,t,"get"))}function f(e,t,i){return function(e,t,i){if(t.set)t.set.call(e,i);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=i}}(e,w(e,t,"set"),i),i}function w(e,t,i){if(!t.has(e))throw new TypeError("attempted to "+i+" private field on non-instance");return t.get(e)}var v=new WeakMap;class b extends d.AbstractSingleEntrySigner{constructor(e,t){super({provider:t}),this.ckitProvider=t,v.set(this,{writable:!0,value:void 0}),f(this,v,e)}getRcIdentity(){return{flag:l.RcIdentityFlag.CKB,pubkeyHash:n.key.privateKeyToBlake160(p(this,v))}}getAddress(){const e=this.ckitProvider.getScriptConfig("RC_LOCK");return this.ckitProvider.parseToAddress({code_hash:e.CODE_HASH,hash_type:e.HASH_TYPE,args:s.bytes.concat(this.getRcIdentity().flag,this.getRcIdentity().pubkeyHash,0)})}async signMessage(e){const t=n.key.signRecoverable(e,p(this,v));return Promise.resolve(new c.Reader((0,r.SerializeRcLockWitnessLock)({signature:new c.Reader(t)})).serializeJson())}}let g;t.RcSecp256k1Signer=b,t.RC_MODE=g,function(e){e.PUBKEY_HASH="00",e.ACP="02"}(g||(t.RC_MODE=g={}));var y=new WeakMap;class m extends d.AbstractSingleEntrySigner{constructor(e,t){super({provider:t}),this.ckitProvider=t,y.set(this,{writable:!0,value:void 0}),f(this,y,e)}getRcIdentity(){return{flag:l.RcIdentityFlag.CKB,pubkeyHash:n.key.privateKeyToBlake160(p(this,y))}}async getAddress(){return await this.getAddressByMode(g.ACP)}async getAddressByMode(e){let t=n.key.privateKeyToBlake160(p(this,y));t.startsWith("0x")&&(t=t.substring(2));let i="0x00".concat(t,"00");switch(e){case g.ACP:i="0x00".concat(t,"020000");break;case g.PUBKEY_HASH:i="0x00".concat(t,"00");break;default:return Promise.reject(new Error("invalid rc mode"))}const r=await this.ckitProvider.getScriptConfig("RC_LOCK");return this.ckitProvider.parseToAddress({code_hash:r.CODE_HASH,hash_type:r.HASH_TYPE,args:i})}async signMessage(e){const t=n.key.signRecoverable(e,p(this,y));return Promise.resolve(new c.Reader((0,r.SerializeRcLockWitnessLock)({signature:new c.Reader(t)})).serializeJson())}}t.RCLockSigner=m;var j=new WeakMap;class _ extends d.AbstractSingleEntrySigner{constructor(e,t){super({provider:t}),this.ckitProvider=t,j.set(this,{writable:!0,value:void 0}),f(this,j,e)}getRcIdentity(){return{flag:l.RcIdentityFlag.ETH,pubkeyHash:this.getEthAddress()}}getAddress(){const e=this.ckitProvider.getScriptConfig("RC_LOCK"),t=this.getEthAddress(),i="0x01".concat(t.substring(2),"00");return this.ckitProvider.parseToAddress({code_hash:e.CODE_HASH,hash_type:e.HASH_TYPE,args:i})}getEthAddress(){const e=(0,o.publicKeyCreate)((0,u.hexToBytes)(p(this,j)),!1).slice(1);return"0x"+(new a.Keccak256Hasher).update(e.buffer).digest().serializeJson().slice(-40)}async signMessage(e){const t=n.key.signRecoverable((0,h.hashMessage)(e),p(this,j));let i=Number.parseInt(t.slice(-2),16);i>=27&&(i-=27);const s="0x"+t.slice(2,-2)+i.toString(16).padStart(2,"0");return Promise.resolve(new c.Reader((0,r.SerializeRcLockWitnessLock)({signature:new c.Reader(s)})).serializeJson())}}t.RcEthSigner=_},731:function(e,t){},733:function(e,t){},742:function(e,t){},744:function(e,t){},770:function(e,t){},771:function(e,t){},776:function(e,t){},778:function(e,t){},785:function(e,t){},804:function(e,t){},832:function(e,t){},836:function(e,t,i){"use strict";function n(e,t){throw new Error("Invalid data length! Required: ".concat(t,", actual: ").concat(e))}function r(e,t){e!==t&&n(e,t)}function s(e){if(e instanceof Object&&e.toArrayBuffer instanceof Function&&(e=e.toArrayBuffer()),!(e instanceof ArrayBuffer))throw new Error("Provided value must be an ArrayBuffer or can be transformed into ArrayBuffer!");return e}function a(e,t,i){e.byteLength<4&&n(e.byteLength,">4");const s=e.getUint32(0,!0);if(r(e.byteLength,s),4===s)return[s];s<8&&n(e.byteLength,">8");const a=e.getUint32(4,!0);if(a%4!==0||a<8)throw new Error("Invalid first offset: ".concat(a));const c=a/4-1;if(c<t)throw new Error("Item count not enough! Required: ".concat(t,", actual: ").concat(c));if(!i&&c>t)throw new Error("Item count is more than required! Required: ".concat(t,", actual: ").concat(c));if(s<a)throw new Error("First offset is larger than byte length: ".concat(a));const o=[];for(let n=0;n<c;n++){const t=4+4*n;o.push(e.getUint32(t,!0))}o.push(s);for(let n=0;n<o.length-1;n++)if(o[n]>o[n+1])throw new Error("Offset index ".concat(n,": ").concat(o[n]," is larger than offset index ").concat(n+1,": ").concat(o[n+1]));return o}function c(e){const t=e.length;let i=4*(t+1);const n=[];for(let c=0;c<t;c++)n.push(i),i+=e[c].byteLength;const r=new ArrayBuffer(i),s=new Uint8Array(r),a=new DataView(r);a.setUint32(0,i,!0);for(let c=0;c<t;c++)a.setUint32(4+4*c,n[c],!0),s.set(new Uint8Array(e[c]),n[c]);return r}Object.defineProperty(t,"__esModule",{value:!0}),t.SerializeIdentity=l,t.SerializeRcIdentity=d,t.SerializeRcIdentityOpt=p,t.SerializeRcLockWitnessLock=function(e){const t=[];return t.push(W(e.signature)),t.push(p(e.rc_identity)),t.push(W(e.preimage)),c(t)},t.SerializeScriptVec=w,t.SerializeScriptVecOpt=b,t.SerializeXudtWitnessInput=function(e){const t=[];return t.push(b(e.raw_extension_data)),t.push(K(e.extension_data)),c(t)},t.SerializeRCRule=y,t.SerializeRCCellVec=j,t.SerializeRCData=function(e){switch(e.type){case"RCRule":{const t=y(e.value),i=new Uint8Array(4+t.byteLength);return new DataView(i.buffer).setUint32(0,0,!0),i.set(new Uint8Array(t),4),i.buffer}case"RCCellVec":{const t=j(e.value),i=new Uint8Array(4+t.byteLength);return new DataView(i.buffer).setUint32(0,1,!0),i.set(new Uint8Array(t),4),i.buffer}default:throw new Error("Invalid type: ".concat(e.type))}},t.SerializeSmtProof=x,t.SerializeSmtProofEntry=S,t.SerializeSmtProofEntryVec=P,t.SerializeSmtUpdateItem=E,t.SerializeSmtUpdateItemVec=U,t.SerializeSmtUpdateAction=function(e){const t=[];return t.push(U(e.updates)),t.push(x(e.proof)),c(t)},t.SerializeXudtData=function(e){const t=[];return t.push(N(e.lock)),t.push(K(e.data)),c(t)},t.SerializeUint32=T,t.SerializeUint64=I,t.SerializeUint128=R,t.SerializeByte32=H,t.SerializeUint256=function(e){const t=s(e);return r(t.byteLength,32),t},t.SerializeBytes=N,t.SerializeBytesOpt=W,t.SerializeBytesVec=K,t.SerializeByte32Vec=q,t.SerializeScriptOpt=J,t.SerializeProposalShortId=G,t.SerializeUncleBlockVec=Q,t.SerializeTransactionVec=te,t.SerializeProposalShortIdVec=ne,t.SerializeCellDepVec=se,t.SerializeCellInputVec=ce,t.SerializeCellOutputVec=le,t.SerializeScript=de,t.SerializeOutPoint=pe,t.SerializeCellInput=we,t.SerializeCellOutput=be,t.SerializeCellDep=ye,t.SerializeRawTransaction=je,t.SerializeTransaction=xe,t.SerializeRawHeader=Se,t.SerializeHeader=Pe,t.SerializeUncleBlock=Ee,t.SerializeBlock=function(e){const t=[];return t.push(Pe(e.header)),t.push(Q(e.uncles)),t.push(te(e.transactions)),t.push(ne(e.proposals)),c(t)},t.SerializeCellbaseWitness=function(e){const t=[];return t.push(de(e.lock)),t.push(N(e.message)),c(t)},t.SerializeWitnessArgs=function(e){const t=[];return t.push(W(e.lock)),t.push(W(e.input_type)),t.push(W(e.output_type)),c(t)},t.WitnessArgs=t.CellbaseWitness=t.Block=t.UncleBlock=t.Header=t.RawHeader=t.Transaction=t.RawTransaction=t.CellDep=t.CellOutput=t.CellInput=t.OutPoint=t.Script=t.CellOutputVec=t.CellInputVec=t.CellDepVec=t.ProposalShortIdVec=t.TransactionVec=t.UncleBlockVec=t.ProposalShortId=t.ScriptOpt=t.Byte32Vec=t.BytesVec=t.BytesOpt=t.Bytes=t.Uint256=t.Byte32=t.Uint128=t.Uint64=t.Uint32=t.XudtData=t.SmtUpdateAction=t.SmtUpdateItemVec=t.SmtUpdateItem=t.SmtProofEntryVec=t.SmtProofEntry=t.SmtProof=t.RCData=t.RCCellVec=t.RCRule=t.XudtWitnessInput=t.ScriptVecOpt=t.ScriptVec=t.RcLockWitnessLock=t.RcIdentityOpt=t.RcIdentity=t.Identity=void 0;class o{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){r(this.view.byteLength,21)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 21}}function l(e){const t=s(e);return r(t.byteLength,21),t}t.Identity=o;class u{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new o(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new A(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()}getIdentity(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new o(this.view.buffer.slice(e,t),{validate:!1})}getProofs(){const e=this.view.getUint32(8,!0),t=this.view.byteLength;return new A(this.view.buffer.slice(e,t),{validate:!1})}}function d(e){const t=[];return t.push(l(e.identity)),t.push(P(e.proofs)),c(t)}t.RcIdentity=u;class h{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.hasValue()&&this.value().validate(e)}value(){return new u(this.view.buffer,{validate:!1})}hasValue(){return this.view.byteLength>0}}function p(e){return e?d(e):new ArrayBuffer(0)}t.RcIdentityOpt=h;t.RcLockWitnessLock=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new V(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new h(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new V(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate()}getSignature(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new V(this.view.buffer.slice(e,t),{validate:!1})}getRcIdentity(){const e=this.view.getUint32(8,!0),t=this.view.getUint32(12,!0);return new h(this.view.buffer.slice(e,t),{validate:!1})}getPreimage(){const e=this.view.getUint32(12,!0),t=this.view.byteLength;return new V(this.view.buffer.slice(e,t),{validate:!1})}};class f{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);for(let i=0;i<len(t)-1;i++)new ue(this.view.buffer.slice(t[i],t[i+1]),{validate:!1}).validate()}length(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1}indexAt(e){const t=4+4*e,i=this.view.getUint32(t,!0);let n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new ue(this.view.buffer.slice(i,n),{validate:!1})}}function w(e){return c(e.map((e=>de(e))))}t.ScriptVec=f;class v{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.hasValue()&&this.value().validate(e)}value(){return new f(this.view.buffer,{validate:!1})}hasValue(){return this.view.byteLength>0}}function b(e){return e?w(e):new ArrayBuffer(0)}t.ScriptVecOpt=v;t.XudtWitnessInput=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new v(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new F(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()}getRawExtensionData(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new v(this.view.buffer.slice(e,t),{validate:!1})}getExtensionData(){const e=this.view.getUint32(8,!0),t=this.view.byteLength;return new F(this.view.buffer.slice(e,t),{validate:!1})}};class g{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}getSmtRoot(){return new B(this.view.buffer.slice(0,0+B.size()),{validate:!1})}getFlags(){return this.view.getUint8(0+B.size())}validate(e=!1){r(this.view.byteLength,g.size()),this.getSmtRoot().validate(e)}static size(){return 0+B.size()+1}}function y(e){const t=new Uint8Array(0+B.size()+1),i=new DataView(t.buffer);return t.set(new Uint8Array(H(e.smt_root)),0),i.setUint8(0+B.size(),e.flags),t.buffer}t.RCRule=g;class m{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&n(this.view.byteLength,">4");const t=this.length()*B.size()+4;r(this.view.byteLength,t);for(let i=0;i<0;i++){this.indexAt(i).validate(e)}}indexAt(e){return new B(this.view.buffer.slice(4+e*B.size(),4+(e+1)*B.size()),{validate:!1})}length(){return this.view.getUint32(0,!0)}}function j(e){const t=new Uint8Array(4+B.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(let i=0;i<e.length;i++){const n=H(e[i]);t.set(new Uint8Array(n),4+i*B.size())}return t.buffer}t.RCCellVec=m;t.RCData=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&r(this.view.byteLength,">4");const t=this.view.getUint32(0,!0);switch(t){case 0:new g(this.view.buffer.slice(4),{validate:!1}).validate();break;case 1:new m(this.view.buffer.slice(4),{validate:!1}).validate();break;default:throw new Error("Invalid type: ".concat(t))}}unionType(){const e=this.view.getUint32(0,!0);switch(e){case 0:return"RCRule";case 1:return"RCCellVec";default:throw new Error("Invalid type: ".concat(e))}}value(){const e=this.view.getUint32(0,!0);switch(e){case 0:return new g(this.view.buffer.slice(4),{validate:!1});case 1:return new m(this.view.buffer.slice(4),{validate:!1});default:throw new Error("Invalid type: ".concat(e))}}};class _{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&n(this.view.byteLength,">4");const t=this.length()+4;r(this.view.byteLength,t)}raw(){return this.view.buffer.slice(4)}indexAt(e){return this.view.getUint8(4+e)}length(){return this.view.getUint32(0,!0)}}function x(e){const t=s(e),i=new Uint8Array(4+t.byteLength);return new DataView(i.buffer).setUint32(0,t.byteLength,!0),i.set(new Uint8Array(t),4),i.buffer}t.SmtProof=_;class O{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);if(t[1]-t[0]!==1)throw new Error("Invalid offset for mask: ".concat(t[0]," - ").concat(t[1]));new _(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()}getMask(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new DataView(this.view.buffer.slice(e,t)).getUint8(0)}getProof(){const e=this.view.getUint32(8,!0),t=this.view.byteLength;return new _(this.view.buffer.slice(e,t),{validate:!1})}}function S(e){const t=[],i=new DataView(new ArrayBuffer(1));return i.setUint8(0,e.mask),t.push(i.buffer),t.push(x(e.proof)),c(t)}t.SmtProofEntry=O;class A{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);for(let i=0;i<len(t)-1;i++)new O(this.view.buffer.slice(t[i],t[i+1]),{validate:!1}).validate()}length(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1}indexAt(e){const t=4+4*e,i=this.view.getUint32(t,!0);let n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new O(this.view.buffer.slice(i,n),{validate:!1})}}function P(e){return c(e.map((e=>S(e))))}t.SmtProofEntryVec=A;class C{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}getKey(){return new B(this.view.buffer.slice(0,0+B.size()),{validate:!1})}getPackedValues(){return this.view.getUint8(0+B.size())}validate(e=!1){r(this.view.byteLength,C.size()),this.getKey().validate(e)}static size(){return 0+B.size()+1}}function E(e){const t=new Uint8Array(0+B.size()+1),i=new DataView(t.buffer);return t.set(new Uint8Array(H(e.key)),0),i.setUint8(0+B.size(),e.packed_values),t.buffer}t.SmtUpdateItem=C;class k{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&n(this.view.byteLength,">4");const t=this.length()*C.size()+4;r(this.view.byteLength,t);for(let i=0;i<0;i++){this.indexAt(i).validate(e)}}indexAt(e){return new C(this.view.buffer.slice(4+e*C.size(),4+(e+1)*C.size()),{validate:!1})}length(){return this.view.getUint32(0,!0)}}function U(e){const t=new Uint8Array(4+C.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(let i=0;i<e.length;i++){const n=E(e[i]);t.set(new Uint8Array(n),4+i*C.size())}return t.buffer}t.SmtUpdateItemVec=k;t.SmtUpdateAction=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new k(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new _(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()}getUpdates(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new k(this.view.buffer.slice(e,t),{validate:!1})}getProof(){const e=this.view.getUint32(8,!0),t=this.view.byteLength;return new _(this.view.buffer.slice(e,t),{validate:!1})}};t.XudtData=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new M(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new F(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()}getLock(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new M(this.view.buffer.slice(e,t),{validate:!1})}getData(){const e=this.view.getUint32(8,!0),t=this.view.byteLength;return new F(this.view.buffer.slice(e,t),{validate:!1})}};class z{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){r(this.view.byteLength,4)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}toBigEndianUint32(){return this.view.getUint32(0,!1)}toLittleEndianUint32(){return this.view.getUint32(0,!0)}static size(){return 4}}function T(e){const t=s(e);return r(t.byteLength,4),t}t.Uint32=z;class L{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){r(this.view.byteLength,8)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 8}}function I(e){const t=s(e);return r(t.byteLength,8),t}t.Uint64=L;class D{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){r(this.view.byteLength,16)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 16}}function R(e){const t=s(e);return r(t.byteLength,16),t}t.Uint128=D;class B{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){r(this.view.byteLength,32)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 32}}function H(e){const t=s(e);return r(t.byteLength,32),t}t.Byte32=B;t.Uint256=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){r(this.view.byteLength,32)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 32}};class M{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&n(this.view.byteLength,">4");const t=this.length()+4;r(this.view.byteLength,t)}raw(){return this.view.buffer.slice(4)}indexAt(e){return this.view.getUint8(4+e)}length(){return this.view.getUint32(0,!0)}}function N(e){const t=s(e),i=new Uint8Array(4+t.byteLength);return new DataView(i.buffer).setUint32(0,t.byteLength,!0),i.set(new Uint8Array(t),4),i.buffer}t.Bytes=M;class V{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.hasValue()&&this.value().validate(e)}value(){return new M(this.view.buffer,{validate:!1})}hasValue(){return this.view.byteLength>0}}function W(e){return e?N(e):new ArrayBuffer(0)}t.BytesOpt=V;class F{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);for(let i=0;i<len(t)-1;i++)new M(this.view.buffer.slice(t[i],t[i+1]),{validate:!1}).validate()}length(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1}indexAt(e){const t=4+4*e,i=this.view.getUint32(t,!0);let n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new M(this.view.buffer.slice(i,n),{validate:!1})}}function K(e){return c(e.map((e=>N(e))))}t.BytesVec=F;class Y{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&n(this.view.byteLength,">4");const t=this.length()*B.size()+4;r(this.view.byteLength,t);for(let i=0;i<0;i++){this.indexAt(i).validate(e)}}indexAt(e){return new B(this.view.buffer.slice(4+e*B.size(),4+(e+1)*B.size()),{validate:!1})}length(){return this.view.getUint32(0,!0)}}function q(e){const t=new Uint8Array(4+B.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(let i=0;i<e.length;i++){const n=H(e[i]);t.set(new Uint8Array(n),4+i*B.size())}return t.buffer}t.Byte32Vec=Y;class X{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.hasValue()&&this.value().validate(e)}value(){return new ue(this.view.buffer,{validate:!1})}hasValue(){return this.view.byteLength>0}}function J(e){return e?de(e):new ArrayBuffer(0)}t.ScriptOpt=X;class Z{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){r(this.view.byteLength,10)}indexAt(e){return this.view.getUint8(e)}raw(){return this.view.buffer}static size(){return 10}}function G(e){const t=s(e);return r(t.byteLength,10),t}t.ProposalShortId=Z;class ${constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);for(let i=0;i<len(t)-1;i++)new Ce(this.view.buffer.slice(t[i],t[i+1]),{validate:!1}).validate()}length(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1}indexAt(e){const t=4+4*e,i=this.view.getUint32(t,!0);let n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new Ce(this.view.buffer.slice(i,n),{validate:!1})}}function Q(e){return c(e.map((e=>Ee(e))))}t.UncleBlockVec=$;class ee{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);for(let i=0;i<len(t)-1;i++)new _e(this.view.buffer.slice(t[i],t[i+1]),{validate:!1}).validate()}length(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1}indexAt(e){const t=4+4*e,i=this.view.getUint32(t,!0);let n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new _e(this.view.buffer.slice(i,n),{validate:!1})}}function te(e){return c(e.map((e=>xe(e))))}t.TransactionVec=ee;class ie{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&n(this.view.byteLength,">4");const t=this.length()*Z.size()+4;r(this.view.byteLength,t);for(let i=0;i<0;i++){this.indexAt(i).validate(e)}}indexAt(e){return new Z(this.view.buffer.slice(4+e*Z.size(),4+(e+1)*Z.size()),{validate:!1})}length(){return this.view.getUint32(0,!0)}}function ne(e){const t=new Uint8Array(4+Z.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(let i=0;i<e.length;i++){const n=G(e[i]);t.set(new Uint8Array(n),4+i*Z.size())}return t.buffer}t.ProposalShortIdVec=ie;class re{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&n(this.view.byteLength,">4");const t=this.length()*ge.size()+4;r(this.view.byteLength,t);for(let i=0;i<0;i++){this.indexAt(i).validate(e)}}indexAt(e){return new ge(this.view.buffer.slice(4+e*ge.size(),4+(e+1)*ge.size()),{validate:!1})}length(){return this.view.getUint32(0,!0)}}function se(e){const t=new Uint8Array(4+ge.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(let i=0;i<e.length;i++){const n=ye(e[i]);t.set(new Uint8Array(n),4+i*ge.size())}return t.buffer}t.CellDepVec=re;class ae{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){this.view.byteLength<4&&n(this.view.byteLength,">4");const t=this.length()*fe.size()+4;r(this.view.byteLength,t);for(let i=0;i<0;i++){this.indexAt(i).validate(e)}}indexAt(e){return new fe(this.view.buffer.slice(4+e*fe.size(),4+(e+1)*fe.size()),{validate:!1})}length(){return this.view.getUint32(0,!0)}}function ce(e){const t=new Uint8Array(4+fe.size()*e.length);new DataView(t.buffer).setUint32(0,e.length,!0);for(let i=0;i<e.length;i++){const n=we(e[i]);t.set(new Uint8Array(n),4+i*fe.size())}return t.buffer}t.CellInputVec=ae;class oe{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);for(let i=0;i<len(t)-1;i++)new ve(this.view.buffer.slice(t[i],t[i+1]),{validate:!1}).validate()}length(){return this.view.byteLength<8?0:this.view.getUint32(4,!0)/4-1}indexAt(e){const t=4+4*e,i=this.view.getUint32(t,!0);let n=this.view.byteLength;return e+1<this.length()&&(n=this.view.getUint32(t+4,!0)),new ve(this.view.buffer.slice(i,n),{validate:!1})}}function le(e){return c(e.map((e=>be(e))))}t.CellOutputVec=oe;class ue{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);if(new B(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),t[2]-t[1]!==1)throw new Error("Invalid offset for hash_type: ".concat(t[1]," - ").concat(t[2]));new M(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate()}getCodeHash(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new B(this.view.buffer.slice(e,t),{validate:!1})}getHashType(){const e=this.view.getUint32(8,!0),t=this.view.getUint32(12,!0);return new DataView(this.view.buffer.slice(e,t)).getUint8(0)}getArgs(){const e=this.view.getUint32(12,!0),t=this.view.byteLength;return new M(this.view.buffer.slice(e,t),{validate:!1})}}function de(e){const t=[];t.push(H(e.code_hash));const i=new DataView(new ArrayBuffer(1));return i.setUint8(0,e.hash_type),t.push(i.buffer),t.push(N(e.args)),c(t)}t.Script=ue;class he{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}getTxHash(){return new B(this.view.buffer.slice(0,0+B.size()),{validate:!1})}getIndex(){return new z(this.view.buffer.slice(0+B.size(),0+B.size()+z.size()),{validate:!1})}validate(e=!1){r(this.view.byteLength,he.size()),this.getTxHash().validate(e),this.getIndex().validate(e)}static size(){return 0+B.size()+z.size()}}function pe(e){const t=new Uint8Array(0+B.size()+z.size());new DataView(t.buffer);return t.set(new Uint8Array(H(e.tx_hash)),0),t.set(new Uint8Array(T(e.index)),0+B.size()),t.buffer}t.OutPoint=he;class fe{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}getSince(){return new L(this.view.buffer.slice(0,0+L.size()),{validate:!1})}getPreviousOutput(){return new he(this.view.buffer.slice(0+L.size(),0+L.size()+he.size()),{validate:!1})}validate(e=!1){r(this.view.byteLength,fe.size()),this.getSince().validate(e),this.getPreviousOutput().validate(e)}static size(){return 0+L.size()+he.size()}}function we(e){const t=new Uint8Array(0+L.size()+he.size());new DataView(t.buffer);return t.set(new Uint8Array(I(e.since)),0),t.set(new Uint8Array(pe(e.previous_output)),0+L.size()),t.buffer}t.CellInput=fe;class ve{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new L(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new ue(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new X(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate()}getCapacity(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new L(this.view.buffer.slice(e,t),{validate:!1})}getLock(){const e=this.view.getUint32(8,!0),t=this.view.getUint32(12,!0);return new ue(this.view.buffer.slice(e,t),{validate:!1})}getType(){const e=this.view.getUint32(12,!0),t=this.view.byteLength;return new X(this.view.buffer.slice(e,t),{validate:!1})}}function be(e){const t=[];return t.push(I(e.capacity)),t.push(de(e.lock)),t.push(J(e.type_)),c(t)}t.CellOutput=ve;class ge{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}getOutPoint(){return new he(this.view.buffer.slice(0,0+he.size()),{validate:!1})}getDepType(){return this.view.getUint8(0+he.size())}validate(e=!1){r(this.view.byteLength,ge.size()),this.getOutPoint().validate(e)}static size(){return 0+he.size()+1}}function ye(e){const t=new Uint8Array(0+he.size()+1),i=new DataView(t.buffer);return t.set(new Uint8Array(pe(e.out_point)),0),i.setUint8(0+he.size(),e.dep_type),t.buffer}t.CellDep=ge;class me{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new z(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new re(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new Y(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate(),new ae(this.view.buffer.slice(t[3],t[4]),{validate:!1}).validate(),new oe(this.view.buffer.slice(t[4],t[5]),{validate:!1}).validate(),new F(this.view.buffer.slice(t[5],t[6]),{validate:!1}).validate()}getVersion(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new z(this.view.buffer.slice(e,t),{validate:!1})}getCellDeps(){const e=this.view.getUint32(8,!0),t=this.view.getUint32(12,!0);return new re(this.view.buffer.slice(e,t),{validate:!1})}getHeaderDeps(){const e=this.view.getUint32(12,!0),t=this.view.getUint32(16,!0);return new Y(this.view.buffer.slice(e,t),{validate:!1})}getInputs(){const e=this.view.getUint32(16,!0),t=this.view.getUint32(20,!0);return new ae(this.view.buffer.slice(e,t),{validate:!1})}getOutputs(){const e=this.view.getUint32(20,!0),t=this.view.getUint32(24,!0);return new oe(this.view.buffer.slice(e,t),{validate:!1})}getOutputsData(){const e=this.view.getUint32(24,!0),t=this.view.byteLength;return new F(this.view.buffer.slice(e,t),{validate:!1})}}function je(e){const t=[];return t.push(T(e.version)),t.push(se(e.cell_deps)),t.push(q(e.header_deps)),t.push(ce(e.inputs)),t.push(le(e.outputs)),t.push(K(e.outputs_data)),c(t)}t.RawTransaction=me;class _e{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new me(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new F(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()}getRaw(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new me(this.view.buffer.slice(e,t),{validate:!1})}getWitnesses(){const e=this.view.getUint32(8,!0),t=this.view.byteLength;return new F(this.view.buffer.slice(e,t),{validate:!1})}}function xe(e){const t=[];return t.push(je(e.raw)),t.push(K(e.witnesses)),c(t)}t.Transaction=_e;class Oe{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}getVersion(){return new z(this.view.buffer.slice(0,0+z.size()),{validate:!1})}getCompactTarget(){return new z(this.view.buffer.slice(0+z.size(),0+z.size()+z.size()),{validate:!1})}getTimestamp(){return new L(this.view.buffer.slice(0+z.size()+z.size(),0+z.size()+z.size()+L.size()),{validate:!1})}getNumber(){return new L(this.view.buffer.slice(0+z.size()+z.size()+L.size(),0+z.size()+z.size()+L.size()+L.size()),{validate:!1})}getEpoch(){return new L(this.view.buffer.slice(0+z.size()+z.size()+L.size()+L.size(),0+z.size()+z.size()+L.size()+L.size()+L.size()),{validate:!1})}getParentHash(){return new B(this.view.buffer.slice(0+z.size()+z.size()+L.size()+L.size()+L.size(),0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()),{validate:!1})}getTransactionsRoot(){return new B(this.view.buffer.slice(0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size(),0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()),{validate:!1})}getProposalsHash(){return new B(this.view.buffer.slice(0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size(),0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()+B.size()),{validate:!1})}getUnclesHash(){return new B(this.view.buffer.slice(0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()+B.size(),0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()+B.size()+B.size()),{validate:!1})}getDao(){return new B(this.view.buffer.slice(0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()+B.size()+B.size(),0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()+B.size()+B.size()+B.size()),{validate:!1})}validate(e=!1){r(this.view.byteLength,Oe.size()),this.getVersion().validate(e),this.getCompactTarget().validate(e),this.getTimestamp().validate(e),this.getNumber().validate(e),this.getEpoch().validate(e),this.getParentHash().validate(e),this.getTransactionsRoot().validate(e),this.getProposalsHash().validate(e),this.getUnclesHash().validate(e),this.getDao().validate(e)}static size(){return 0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()+B.size()+B.size()+B.size()}}function Se(e){const t=new Uint8Array(0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()+B.size()+B.size()+B.size());new DataView(t.buffer);return t.set(new Uint8Array(T(e.version)),0),t.set(new Uint8Array(T(e.compact_target)),0+z.size()),t.set(new Uint8Array(I(e.timestamp)),0+z.size()+z.size()),t.set(new Uint8Array(I(e.number)),0+z.size()+z.size()+L.size()),t.set(new Uint8Array(I(e.epoch)),0+z.size()+z.size()+L.size()+L.size()),t.set(new Uint8Array(H(e.parent_hash)),0+z.size()+z.size()+L.size()+L.size()+L.size()),t.set(new Uint8Array(H(e.transactions_root)),0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()),t.set(new Uint8Array(H(e.proposals_hash)),0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()),t.set(new Uint8Array(H(e.uncles_hash)),0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()+B.size()),t.set(new Uint8Array(H(e.dao)),0+z.size()+z.size()+L.size()+L.size()+L.size()+B.size()+B.size()+B.size()+B.size()),t.buffer}t.RawHeader=Oe;class Ae{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}getRaw(){return new Oe(this.view.buffer.slice(0,0+Oe.size()),{validate:!1})}getNonce(){return new D(this.view.buffer.slice(0+Oe.size(),0+Oe.size()+D.size()),{validate:!1})}validate(e=!1){r(this.view.byteLength,Ae.size()),this.getRaw().validate(e),this.getNonce().validate(e)}static size(){return 0+Oe.size()+D.size()}}function Pe(e){const t=new Uint8Array(0+Oe.size()+D.size());new DataView(t.buffer);return t.set(new Uint8Array(Se(e.raw)),0),t.set(new Uint8Array(R(e.nonce)),0+Oe.size()),t.buffer}t.Header=Ae;class Ce{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new Ae(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new ie(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()}getHeader(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new Ae(this.view.buffer.slice(e,t),{validate:!1})}getProposals(){const e=this.view.getUint32(8,!0),t=this.view.byteLength;return new ie(this.view.buffer.slice(e,t),{validate:!1})}}function Ee(e){const t=[];return t.push(Pe(e.header)),t.push(ne(e.proposals)),c(t)}t.UncleBlock=Ce;t.Block=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new Ae(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new $(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new ee(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate(),new ie(this.view.buffer.slice(t[3],t[4]),{validate:!1}).validate()}getHeader(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new Ae(this.view.buffer.slice(e,t),{validate:!1})}getUncles(){const e=this.view.getUint32(8,!0),t=this.view.getUint32(12,!0);return new $(this.view.buffer.slice(e,t),{validate:!1})}getTransactions(){const e=this.view.getUint32(12,!0),t=this.view.getUint32(16,!0);return new ee(this.view.buffer.slice(e,t),{validate:!1})}getProposals(){const e=this.view.getUint32(16,!0),t=this.view.byteLength;return new ie(this.view.buffer.slice(e,t),{validate:!1})}};t.CellbaseWitness=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new ue(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new M(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate()}getLock(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new ue(this.view.buffer.slice(e,t),{validate:!1})}getMessage(){const e=this.view.getUint32(8,!0),t=this.view.byteLength;return new M(this.view.buffer.slice(e,t),{validate:!1})}};t.WitnessArgs=class{constructor(e,{validate:t=!0}={}){this.view=new DataView(s(e)),t&&this.validate()}validate(e=!1){const t=a(this.view,0,!0);new V(this.view.buffer.slice(t[0],t[1]),{validate:!1}).validate(),new V(this.view.buffer.slice(t[1],t[2]),{validate:!1}).validate(),new V(this.view.buffer.slice(t[2],t[3]),{validate:!1}).validate()}getLock(){const e=this.view.getUint32(4,!0),t=this.view.getUint32(8,!0);return new V(this.view.buffer.slice(e,t),{validate:!1})}getInputType(){const e=this.view.getUint32(8,!0),t=this.view.getUint32(12,!0);return new V(this.view.buffer.slice(e,t),{validate:!1})}getOutputType(){const e=this.view.getUint32(12,!0),t=this.view.byteLength;return new V(this.view.buffer.slice(e,t),{validate:!1})}}},837:function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.convertToRcIdentityFlag=v,t.convertToSudtSupplyInfo=b,t.convertToSudtInfo=g,t.RcSupplyLockHelper=t.RcLockFlag=t.RcIdentityFlag=t.RcSupplyOutputData=t.RcSupplyLockArgs=t.RcIdentityLockArgs=void 0;var n=i(114),r=i(298),s=i(150),a=i(99),c=i(1211),o=i(1214),l=i(579);function u(e){return{byteWidth:e,read:(t,i=0)=>(0,r.formatByteLike)(t.slice(i,i+e),{pad0x:!0}),write(t,i,n=0){const s=(0,r.formatByteLike)(i,{rm0x:!0});t.write(s,n,e,"hex")}}}const d=(0,r.createFixedStruct)().field("rc_identity_flag",(0,r.createField)(1,((e,t)=>v(e.readUInt8(t))),r.U8.write)).field("rc_identity_pubkey_hash",u(20)).field("rc_lock_flag",r.U8);t.RcIdentityLockArgs=d;const h=d.field("type_id_hash",u(32));t.RcSupplyLockArgs=h;const p=(0,r.createFixedStruct)().field("version",r.U8).field("current_supply",r.U128LE).field("max_supply",r.U128LE).field("sudt_script_hash",u(32));let f,w;function v(e){const t=Number(s.bytes.toHex(e));if(t===f.CKB)return f.CKB;if(t===f.ETH)return f.ETH;throw new Error("Unknown RC Identity flag: ".concat(t))}function b(t){const{current_supply:i,max_supply:n,version:c}=p.decode((0,r.toBuffer)(t)),o=p.fields.reduce(((e,t)=>e+t[1].byteWidth),0),u=new l.UdtInfo(new a.Reader(s.bytes.toHex(t.slice(2+2*o))));return{version:s.bytes.toHex(c),currentSupply:s.bytes.toHex(i),maxSupply:s.bytes.toHex(n),description:e.from(u.getDescription().raw()).toString(),symbol:e.from(u.getSymbol().raw()).toString(),name:e.from(u.getName().raw()).toString(),decimals:u.getDecimals()}}function g(e){const{rc_identity_flag:t,rc_identity_pubkey_hash:i,type_id_hash:n}=h.decode((0,r.toBuffer)(e.output.lock.args));return{rcIdentity:{flag:t,pubkeyHash:i},udtId:n,...b(e.output_data)}}t.RcSupplyOutputData=p,t.RcIdentityFlag=f,function(e){e[e.CKB=0]="CKB",e[e.ETH=1]="ETH"}(f||(t.RcIdentityFlag=f={})),t.RcLockFlag=w,function(e){e[e.ROOT=1]="ROOT",e[e.ACP_MASK=2]="ACP_MASK",e[e.SINCE_MASK=4]="SINCE_MASK",e[e.SUPPLY_MASK=8]="SUPPLY_MASK"}(w||(t.RcLockFlag=w={}));t.RcSupplyLockHelper=class{constructor(e,t){this.indexer=e,this.config=t}async listCreatedInfoCells(e){const{rcIdentity:t,udtId:i}=e,n=this.indexer,r={script:{...this.config.rcLock,args:s.bytes.concat(t.flag,t.pubkeyHash,w.SUPPLY_MASK,null!==i&&void 0!==i?i:"")},script_type:"lock"},a=(0,c.from)(n.get_cells({search_key:r})).pipe((0,o.expand)((e=>n.get_cells({search_key:r,after_cursor:e.last_cursor})),1),(0,o.takeWhile)((e=>e.objects.length>0)),(0,o.concatMap)((e=>e.objects)),(0,o.toArray)());return(0,c.lastValueFrom)(a)}async listCreatedSudt(e){return(await this.listCreatedInfoCells(e)).map(g)}newRcSupplyLockScript({rcIdentity:e,udtId:t}){return{...this.config.rcLock,args:s.bytes.toHex(h.encode({rc_identity_flag:e.flag,rc_identity_pubkey_hash:e.pubkeyHash,rc_lock_flag:w.SUPPLY_MASK,type_id_hash:t}))}}newSudtScript({rcIdentity:e,udtId:t}){const i=this.newRcSupplyLockScript({rcIdentity:e,udtId:t});return{...this.config.sudtType,args:n.utils.computeScriptHash(i)}}}}).call(this,i(13).Buffer)},900:function(e,t){}},[[1210,1,2]]]);
//# sourceMappingURL=main.0bdb0824.chunk.js.map